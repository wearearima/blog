<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.0.0">Jekyll</generator><link href="https://blog.arima.eu/es/feed.xml" rel="self" type="application/atom+xml" /><link href="https://blog.arima.eu/es/" rel="alternate" type="text/html" /><updated>2020-07-06T08:48:04+00:00</updated><id>https://blog.arima.eu/feed.xml</id><title type="html">ARIMA</title><subtitle></subtitle><entry xml:lang="es"><title type="html">Descubriendo JUnit 5: Tests Parametrizados</title><link href="https://blog.arima.eu/es/2020/07/01/parameterized-tests.html" rel="alternate" type="text/html" title="Descubriendo JUnit 5: Tests Parametrizados" /><published>2020-07-01T09:00:00+00:00</published><updated>2020-07-01T09:00:00+00:00</updated><id>https://blog.arima.eu/2020/07/01/parameterized-tests</id><content type="html" xml:base="https://blog.arima.eu/2020/07/01/parameterized-tests.html">&lt;p&gt;Estaba preparando el ejemplo de tests para el post &lt;a href=&quot;https://blog.arima.eu/2020/05/25/mutation-testing.html&quot; target=&quot;_blank&quot;&gt;Mutation testing systems, mejorando la calidad de los tests&lt;/a&gt; y me surgi√≥ una duda sobre si podr√≠a probar de forma m√°s exhaustiva el m√©todo under test, ya que era consciente de que me dejaba algunos ejemplos sin probar.&lt;/p&gt;

&lt;p&gt;El m√©todo de ejemplo a testear es:&lt;/p&gt;
&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;DayStatusSummary&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;getDayStatusSummaryForWorkerAndDay&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;workerUserName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;LocalDate&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;date&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

  &lt;span class=&quot;nc&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Worklog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;worklogsForDay&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;worklogRepository&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;findByUsernameAndDate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;workerUserName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;date&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;totalDuration&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;worklogsForDay&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;mapToInt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Worklog:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getDuration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;

  &lt;span class=&quot;nc&quot;&gt;DayStatusSummary&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;DayStatusSummary&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;date&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;workerUserName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;totalDuration&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addDayStatus&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;RIGHT_HOURS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;totalDuration&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addDayStatus&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;EXTRA_HOURS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addDayStatus&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;MISSING_HOURS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;B√°sicamente lo que hace es a partir de un conjunto de worklogs se encarga de sumar las duraciones y comprobarlas ‚Äúcontra‚Äù la jornada est√°ndar de 8 horas. Si la suma es &amp;gt; 8 debe indicar que hay horas extras, si es &amp;lt; 8 faltar√°n por imputar horas y si es 8 todo estar√° OK.&lt;/p&gt;

&lt;p&gt;Este caso es bastante trivial, pero si lo extrapolamos a m√©todos m√°s complejos, no es la primera situaci√≥n de estas caracter√≠sticas que me encuentro, y normalmente termino creando varios tests con diferentes combinaciones finitas, de casos de ejemplo acotados, que normalmente podr√≠a sacar de una tabla de este tipo:&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;¬†&lt;/th&gt;
      &lt;th&gt;¬†&lt;/th&gt;
      &lt;th&gt;1 √∫nico worklog&lt;/th&gt;
      &lt;th&gt;lista de n worklogs (n&amp;lt;1)&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;caso 1&lt;/td&gt;
      &lt;td&gt;suma = 8&lt;/td&gt;
      &lt;td&gt;test&lt;/td&gt;
      &lt;td&gt;test&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;caso 2&lt;/td&gt;
      &lt;td&gt;suma = a (a&amp;lt;8)&lt;/td&gt;
      &lt;td&gt;test&lt;/td&gt;
      &lt;td&gt;test&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;caso 3&lt;/td&gt;
      &lt;td&gt;suma = b (b&amp;gt;8)&lt;/td&gt;
      &lt;td&gt;test&lt;/td&gt;
      &lt;td&gt;test&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;As√≠ a priori mi bater√≠a de tests para este m√©todo podr√≠a ser la siguiente&lt;sup id=&quot;fnref:1&quot;&gt;&lt;a href=&quot;#fn:1&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/2020-06-30-parameterized-tests/01_test_set.png&quot; alt=&quot;Primera aproximaci√≥n del set de tests&quot; class=&quot;center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Teniendo en cuenta que &lt;code class=&quot;highlighter-rouge&quot;&gt;n&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;a&lt;/code&gt; y &lt;code class=&quot;highlighter-rouge&quot;&gt;b&lt;/code&gt; los fijar√© (en este caso &lt;code class=&quot;highlighter-rouge&quot;&gt;n = 3&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;a = 7&lt;/code&gt; y &lt;code class=&quot;highlighter-rouge&quot;&gt;b = 9&lt;/code&gt;) siempre me quedo con la duda de que estoy testeando algunos ejemplos pero no otros: &lt;code class=&quot;highlighter-rouge&quot;&gt;suma = 7&lt;/code&gt; pero no &lt;code class=&quot;highlighter-rouge&quot;&gt;suma = 0&lt;/code&gt;o &lt;code class=&quot;highlighter-rouge&quot;&gt;suma = 9&lt;/code&gt; pero no &lt;code class=&quot;highlighter-rouge&quot;&gt;suma = 10&lt;/code&gt;, o listas de 1 y 3 elementos pero no de 0 o m√°s de 3‚Ä¶.&lt;/p&gt;

&lt;p&gt;En este caso en el que los casos 1 y 2 son muy acotados podr√≠a liarme la manta a la cabeza y hacer tests exhaustivos que probasen todos los casos‚Ä¶ Por ejemplo&lt;sup id=&quot;fnref:2&quot;&gt;&lt;a href=&quot;#fn:2&quot; class=&quot;footnote&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/2020-06-30-parameterized-tests/02_test_set.png&quot; alt=&quot;Segunda aproximaci√≥n del set de tests&quot; class=&quot;center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Pero nunca me ha parecido algo apropiado porque pensando en esfuerzo vs beneficio parece que no compensa, y porque aumentar tanto la clase de test con m√©todos tan ‚Äúredundantes‚Äù probablemente haga que mi clase de tests termine siendo infumable. El ejemplo anterior ratificar√≠a esta idea‚Ä¶ y ni siquiera cubrimos todos los ejemplos que se nos podr√≠an ocurrir‚Ä¶ ¬°s√≥lo hemos cubierto ejemplos del &lt;em&gt;caso 2&lt;/em&gt; con &lt;em&gt;un √∫nico worklog&lt;/em&gt;!&lt;/p&gt;

&lt;p&gt;¬°Otra idea!, ¬øpor qu√© no iterar &lt;code class=&quot;highlighter-rouge&quot;&gt;n&lt;/code&gt; veces la ejecuci√≥n del m√©todo SUT junto el assert asociado, y personalizar el mensaje de error utilizando el par√°metro de la iteraci√≥n?&lt;/p&gt;

&lt;p&gt;Algo as√≠ como el siguiente ejemplo&lt;sup id=&quot;fnref:3&quot;&gt;&lt;a href=&quot;#fn:3&quot; class=&quot;footnote&quot;&gt;3&lt;/a&gt;&lt;/sup&gt;:&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nd&quot;&gt;@Test&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;when_the_worklog_for_the_resquested_day_is_less_than_8_hours_the_status_is_MISSING_HOURS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nc&quot;&gt;Worklog&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Worklog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;when&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getDuration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;thenReturn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;when&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;worklogRepository&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;findByUsernameAndDate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;ArgumentMatchers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;anyString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;ArgumentMatchers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;LocalDate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;thenReturn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Arrays&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;asList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;

    &lt;span class=&quot;nc&quot;&gt;DayStatusSummary&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reportsService&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getDayStatusSummaryForWorkerAndDay&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;USERNAME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;DAY&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;nc&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Integer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;durations&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Arrays&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;asList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;DayStatus&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resultStatusList&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getStatusList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;assertEquals&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resultStatusList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Statuslist size failed for worklogs with duration &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;durations&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;assertEquals&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;MISSING_HOURS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resultStatusList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Daystatus failed for with duration &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;durations&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;En este caso estar√© ejecutando un √∫nico test, pero si falla para alg√∫n valor de &lt;code class=&quot;highlighter-rouge&quot;&gt;i&lt;/code&gt;, el mensaje de error me indicar√° el ejemplo que falla.&lt;/p&gt;

&lt;p&gt;Vale, con esto cubro los casos m√°s acotados‚Ä¶.. y ¬øpara los menos acotados? Se me ocurre generar varios valores random y aplicar el mismo patr√≥n&lt;sup id=&quot;fnref:4&quot;&gt;&lt;a href=&quot;#fn:4&quot; class=&quot;footnote&quot;&gt;4&lt;/a&gt;&lt;/sup&gt;:&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nd&quot;&gt;@Test&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;when_the_worklog_for_the_resquested_day_is_more_than_8_hours_the_status_is_EXTRA_HOURS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nc&quot;&gt;Worklog&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Worklog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nc&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Integer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;worklogDurations&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;ints&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Integer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;MAX_VALUE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;boxed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;collect&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Collectors&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Integer&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;worklogDurations&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;when&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getDuration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;thenReturn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;when&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;worklogRepository&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;findByUsernameAndDate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;ArgumentMatchers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;anyString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;ArgumentMatchers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;LocalDate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;thenReturn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Arrays&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;asList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;

    &lt;span class=&quot;nc&quot;&gt;DayStatusSummary&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reportsService&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getDayStatusSummaryForWorkerAndDay&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;USERNAME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;DAY&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;nc&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Integer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;durations&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Arrays&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;asList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;DayStatus&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resultStatusList&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getStatusList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;assertEquals&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resultStatusList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Statuslist size failed for worklogs with duration &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;durations&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;assertEquals&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;EXTRA_HOURS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resultStatusList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Daystatus failed for with duration &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;durations&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Pues s√≠, reconozco que alguna vez (en alguno de mis sideprojects) he hecho alguna de estas ‚Äúchapucillas‚Äùü§´üò∞. Digo chapucilla, porque a priori no suena muy bien hacer estas triqui√±uelas‚Ä¶ (pero bueno, hay tests, hay cobertura de mutantes, estoy trasteando, as√≠ practico testing‚Ä¶..). Excusas y m√°s excusas. Intento enga√±arme a m√≠ misma y no duermo tranquila. Amanezco, pensando en c√≥mo podr√≠a cubrir estos ‚Äúvac√≠os‚Äù aparentes. Es un caso sencillo‚Ä¶ ¬øno hay nada que pueda ayudarme en esto?&lt;/p&gt;

&lt;p&gt;La respuesta es que s√≠, y ¬°encima lo ofrece JUnit 5 por s√≠ mismo!: no me hace falta ninguna herramienta nueva, s√≥lo sacarle m√°s chicha a la que tengo. La soluci√≥n: &lt;a href=&quot;https://junit.org/junit5/docs/current/user-guide/#writing-tests-parameterized-tests&quot; target=&quot;_blank&quot;&gt;Parameterizered Tests&lt;/a&gt;. Est√°n en modo experimental para la √∫ltima versi√≥n de JUnit 5, pero lo cierto es que est√°n disponibles desde la versi√≥n 5.0 ¬°y yo sin conocerlos! Vamos a probarlo.&lt;/p&gt;

&lt;p&gt;Lo primero es a√±adir en el &lt;code class=&quot;highlighter-rouge&quot;&gt;pom.xml&lt;/code&gt; la dependencia correspondiente:&lt;/p&gt;
&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- https://mvnrepository.com/artifact/org.junit.jupiter/junit-jupiter-params --&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.junit.jupiter&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;junit-jupiter-params&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;scope&amp;gt;&lt;/span&gt;test&lt;span class=&quot;nt&quot;&gt;&amp;lt;/scope&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;A continuaci√≥n, modificamos el primer test utilizando la anotaci√≥n y queda como sigue:&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nd&quot;&gt;@ParameterizedTest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Given a worklog for the requested day with {0} duration the status is MISSING_HOURS&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@ValueSource&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ints&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;})&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;worklog_duration_for_requested_day_less_than_8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Integer&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;duration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nc&quot;&gt;Worklog&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Worklog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;when&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getDuration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;thenReturn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;duration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;when&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;worklogRepository&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;findByUsernameAndDate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;ArgumentMatchers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;anyString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt;
      &lt;span class=&quot;nc&quot;&gt;ArgumentMatchers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;LocalDate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;thenReturn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Arrays&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;asList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;

  &lt;span class=&quot;nc&quot;&gt;DayStatusSummary&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reportsService&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getDayStatusSummaryForWorkerAndDay&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;USERNAME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;DAY&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;assertStatusEquals&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;MISSING_HOURS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Tras esta modificaci√≥n no estamos ejecutando un s√≥lo test, &lt;strong&gt;estamos ejecutando 8 tests&lt;/strong&gt;:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/2020-06-30-parameterized-tests/03_test_parameterized.png&quot; alt=&quot;Ejemplo de parameterized&quot; class=&quot;center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Adem√°s, si por ejemplo, quisi√©ramos hacer lo mismo con el m√©todo que utilizaba valores random, podr√≠amos conseguir algo similar haciendo:&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nd&quot;&gt;@ParameterizedTest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Given a worklog for the requested day {0} the status is EXTRA_HOURS&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@MethodSource&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;worklog_duration_for_requested_day_more_than_8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Worklog&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;when&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;worklogRepository&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;findByUsernameAndDate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;ArgumentMatchers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;anyString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt;
      &lt;span class=&quot;nc&quot;&gt;ArgumentMatchers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;LocalDate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;thenReturn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Arrays&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;asList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;

  &lt;span class=&quot;nc&quot;&gt;DayStatusSummary&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reportsService&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getDayStatusSummaryForWorkerAndDay&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;USERNAME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;DAY&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;assertStatusEquals&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;EXTRA_HOURS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Stream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Worklog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;worklog_duration_for_requested_day_more_than_8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// since 24h/day --&amp;gt; max value is 24&lt;/span&gt;
  &lt;span class=&quot;nc&quot;&gt;Stream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Integer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;randomDurations&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;ints&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;boxed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;randomDurations&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;Worklog&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Worklog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;when&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;thenReturn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;[with %d duration]&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// mock info in test description&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;when&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getDuration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;thenReturn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;});&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;En este caso en vez de devolver una lista de enteros con las duraciones hemos probado a hacer el ejemplo devolviendo directamente diferentes worklogs.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/2020-06-30-parameterized-tests/04_test_parameterized_random.png&quot; alt=&quot;Ejemplo de parameterized con valores ramdom&quot; class=&quot;center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Nota: Este ejemplo est√° disponible al completo &lt;a href=&quot;https://github.com/wearearima/time-report-parameterized/tree/feature/04_tests_parameterizedTest&quot; target=&quot;_blank&quot;&gt;en Github&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Otra cosa que siempre he echado de menos de mis tiempos en Grails ha sido la posibilidad de utilizar nombres m√°s ‚Äúlegibles‚Äù para los tests. Y ya que estoy de suerte, y con la anotaci√≥n &lt;code class=&quot;highlighter-rouge&quot;&gt;@ParameterizedTest&lt;/code&gt; puedo poner un nombre‚Ä¶ seguro que hay algo para los tests ‚Äúnormales‚Äù‚Ä¶ ¬°Bingo! Otra anotaci√≥n al rescate: &lt;code class=&quot;highlighter-rouge&quot;&gt;@Displayname&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Pues nada, ahora tengo unos tests mejores, m√°s f√°ciles de entender y de mantener que los de los ejemplos 2 y 3, y m√°s completos que los del ejemplo 1.&lt;/p&gt;

&lt;h2 id=&quot;descubriendo-junit-5&quot;&gt;Descubriendo JUnit 5&lt;/h2&gt;
&lt;p&gt;Nos acostumbramos a hacer las cosas de determinada manera y a veces nos cuesta levantar la mirada y ver si hay herramientas que nos faciliten la vida (que con poco esfuerzo vengan a cubrir carencias que hab√≠amos detectado en nuestro propio c√≥digo). En este caso, hemos descubierto unas anotaciones que nos ayudar√°n en nuestro d√≠a a d√≠a a hacer que nuestros tests sean mejores.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;@ParameterizedTest&lt;/code&gt; para poder crear m√∫ltiples ejemplos para una misma situaci√≥n de un SUT. Los par√°metros de entrada pueden ser tan sencillos como una lista de valores (si s√≥lo se necesita uno utilizando &lt;code class=&quot;highlighter-rouge&quot;&gt;@ValueSource&lt;/code&gt;) o m√°s complejos, desde m√∫ltiples par√°metros para cada test, hasta tipos de par√°metros m√°s complejos (utilizando por ejemplo &lt;code class=&quot;highlighter-rouge&quot;&gt;@MethodSource&lt;/code&gt;). Toda la informaci√≥n puede encontrarse &lt;a href=&quot;https://junit.org/junit5/docs/current/user-guide/#writing-tests-parameterized-tests&quot; target=&quot;_blank&quot;&gt;en esta secci√≥n&lt;/a&gt; de la documentaci√≥n de JUnit 5.&lt;/p&gt;

&lt;p&gt;Adem√°s &lt;code class=&quot;highlighter-rouge&quot;&gt;@DisplayName&lt;/code&gt; para poder poner nombres m√°s legibles a los tests, algo muy √∫til especialmente cuando fallan: poder leer lo que est√° pasando de forma sencilla. Toda la informaci√≥n puede encontrarse &lt;a href=&quot;https://junit.org/junit5/docs/current/user-guide/#writing-tests-display-names&quot; target=&quot;_blank&quot;&gt;en esta secci√≥n&lt;/a&gt; de la documentaci√≥n de JUnit 5.&lt;/p&gt;

&lt;h2 id=&quot;m√°s-all√°&quot;&gt;M√°s all√°‚Ä¶&lt;/h2&gt;
&lt;p&gt;Sin embargo, sigo notando cierto run run: ¬øqu√© pasa con esos casos que no puedo atacar de forma exhaustiva? ¬øPodr√≠a usar &lt;code class=&quot;highlighter-rouge&quot;&gt;@ParameterizedTest&lt;/code&gt;s y pasar random values de diferentes listas?
Parece que s√≠, pero‚Ä¶ en este caso que es sencillo no parece que tenga problemas. Sin embargo y ¬øsi tuviese m√°s par√°metros de entrada o m√°s complejos? ¬øTendr√≠a que desarrollar mi propio ‚Äúgenerador‚Äù de combinaciones aleatorias? ¬øC√≥mo de fr√°giles ser√≠an mis tests? ¬øEs posible hacer tests que no est√©n basados en ejemplo? 
Investigando un poco me encuentro con un concepto que parece que puede encajar: &lt;strong&gt;Property Based Testing&lt;/strong&gt;, donde en base a unos par√°metros de caracter√≠sticas determinadas se verifica una propiedad/comportamiento concreto del SUT.&lt;/p&gt;

&lt;p&gt;No tengo claro si encajar√≠a en este ejemplo, pero ¬øquiz√°s deba profundizar m√°s en el tema para ver si hay algo que podamos aprender y que nos permita mejorar nuestros tests? ¬°Por supuesto, all√° vamos!&lt;/p&gt;
&lt;div class=&quot;footnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:1&quot;&gt;
      &lt;p&gt;C√≥digo fuente para ejemplo de primera versi√≥n de los tests disponible &lt;a href=&quot;https://github.com/wearearima/time-report-parameterized/tree/feature/01_tests_first_approach/src/test/java/eu/arima/tr/reports/reportsServiceImpl/GetDayStatusSummaryForWorkerAndDayTests.java&quot; target=&quot;_blank&quot;&gt;aqu√≠&lt;/a&gt;¬†&lt;a href=&quot;#fnref:1&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:2&quot;&gt;
      &lt;p&gt;C√≥digo fuente para ejemplo de tests exhaustivos disponible &lt;a href=&quot;https://github.com/wearearima/time-report-parameterized/tree/feature/02_tests_exhaustive/src/test/java/eu/arima/tr/reports/reportsServiceImpl/GetDayStatusSummaryForWorkerAndDayTests.java&quot; target=&quot;_blank&quot;&gt;aqu√≠&lt;/a&gt;¬†&lt;a href=&quot;#fnref:2&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:3&quot;&gt;
      &lt;p&gt;C√≥digo fuente para ejemplo de tests iterando SUT disponible &lt;a href=&quot;https://github.com/wearearima/time-report-parameterized/tree/feature/03_tests_tricky_exhaustive/src/test/java/eu/arima/tr/reports/reportsServiceImpl/GetDayStatusSummaryForWorkerAndDayTests.java&quot; target=&quot;_blank&quot;&gt;aqu√≠&lt;/a&gt;¬†&lt;a href=&quot;#fnref:3&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:4&quot;&gt;
      &lt;p&gt;C√≥digo fuente para ejemplo de tests iterando SUT con valores random disponible &lt;a href=&quot;https://github.com/wearearima/time-report-parameterized/tree/feature/03_tests_tricky_exhaustive/src/test/java/eu/arima/tr/reports/reportsServiceImpl/GetDayStatusSummaryForWorkerAndDayTests.java&quot; target=&quot;_blank&quot;&gt;aqu√≠&lt;/a&gt;¬†&lt;a href=&quot;#fnref:4&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;</content><author><name>jessica</name></author><category term="testing," /><category term="calidad," /><category term="software" /><category term="quality," /><category term="QA," /><category term="junit," /><category term="junit" /><category term="5," /><category term="parameterized" /><category term="test" /><summary type="html">Estaba preparando el ejemplo de tests para el post Mutation testing systems, mejorando la calidad de los tests y me surgi√≥ una duda sobre si podr√≠a probar de forma m√°s exhaustiva el m√©todo under test, ya que era consciente de que me dejaba algunos ejemplos sin probar.</summary></entry><entry xml:lang="es"><title type="html">Mutation testing systems, mejorando la calidad de los tests</title><link href="https://blog.arima.eu/es/2020/05/25/mutation-testing.html" rel="alternate" type="text/html" title="Mutation testing systems, mejorando la calidad de los tests" /><published>2020-05-25T09:00:00+00:00</published><updated>2020-05-25T09:00:00+00:00</updated><id>https://blog.arima.eu/2020/05/25/mutation-testing</id><content type="html" xml:base="https://blog.arima.eu/2020/05/25/mutation-testing.html">&lt;p&gt;Profesionalmente me etiqueto como &lt;em&gt;desarrolladora&lt;/em&gt;, aunque no me gustan mucho las etiquetas y me gusta m√°s decir que la raz√≥n de ser de mi trabajo es: crear software de calidad. Pero ¬øqu√© es &lt;strong&gt;software de calidad&lt;/strong&gt;? A mi me gusta definirlo como sigue:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Software de calidad es aquel que satisface las necesidades del usuario de forma eficiente y sin errores.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Podr√≠a a√±adir m√°s adjetivos, entrar en detalle de por qu√© necesidades y no requerimientos‚Ä¶ pero para mi ese ser√≠a el titular. Ahora bien, dif√≠cilmente se puede tener un software de calidad si este no est√° escrito con c√≥digo de calidad.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Software de calidad ‚Üí c√≥digo de calidad&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Afortunadamente, los desarrolladores no nos encontramos solos en esta tarea. Existen herramientas para an√°lisis de c√≥digo de forma est√°tica (Checkstyle, PMD, FindBugs, SonarQube‚Ä¶) y diferentes recomendaciones de buenas pr√°cticas (personalmente destacar√≠a Clean Code y The Pragmatic Programmer). Y ah√≠ entre propuestas, siglas y m√©tricas, no hay desarrollador que no asocie directamente el t√©rmino &lt;em&gt;&lt;strong&gt;calidad&lt;/strong&gt;&lt;/em&gt; con el t√©rmino &lt;em&gt;&lt;strong&gt;testing&lt;/strong&gt;&lt;/em&gt; (¬øverdad?)&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;C√≥digo de calidad ‚Üí tests de calidad&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;testing-el-camino-hacia-la-calidad&quot;&gt;Testing: el camino hacia la calidad&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Tests are as important to the health of a project as the production code is.&lt;/strong&gt;&lt;/p&gt;
  &lt;p align=&quot;right&quot;&gt;&lt;strong&gt;Clean Code.&lt;/strong&gt; Chapter 9: Unit Tests&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Hay varios tipos de test (unitarios, de integraci√≥n, de aceptaci√≥n‚Ä¶). Los m√°s extendidos son los tests unitarios y los tests de integraci√≥n. Con ellos se consigue una cierta percepci√≥n de seguridad, ya que si bien no sabemos si el c√≥digo hace lo que debe, al menos hace lo que dice.&lt;/p&gt;

&lt;p&gt;¬øPero es esto as√≠? Parad√≥jicamente esta pr√°ctica consiste en generar m√°s c√≥digo, es decir, seguimos programando, ¬øqui√©n vela porque este c√≥digo hace lo que dice?, es decir ¬øqui√©n vela por la calidad de los tests? De nuevo otra asociaci√≥n de t√©rminos: &lt;strong&gt;tests de calidad&lt;/strong&gt; son aquellos que ofrecen un % de &lt;strong&gt;cobertura&lt;/strong&gt; del c√≥digo alto.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Tests de calidad ‚Üí % cobertura elevado de nuestro c√≥digo&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;A mayor porcentaje de cobertura de c√≥digo mejores tests y c√≥digo m√°s fiable. Esto no es nada nuevo. Si hablo de mi experiencia personal, hace algunos a√±os (all√° por inicios del 2000) ya formaba parte de las especificaciones de entrega de algunos proyectos el % de cobertura m√≠nimo que deb√≠a tener un proyecto. ‚Äú&lt;em&gt;Este entregable debe tener una bater√≠a de tests que aseguren un m√≠nimo de 70% de cobertura de c√≥digo&lt;/em&gt;‚Äù, como sin√≥nimo de c√≥digo libre de errores y calidad probada en un 70% del c√≥digo al menos.&lt;/p&gt;

&lt;p&gt;Tomando como ejemplo una aplicaci√≥n para controlar los partes de horas trabajados, vamos a imaginar que estamos desarrollando un m√©todo que dados un trabajador y un d√≠a, comprueba el estado de los partes de horas de ese trabajador en ese d√≠a (si ha cumplido o no las horas, si hay partes solapados‚Ä¶.).&lt;/p&gt;

&lt;h5 id=&quot;reportsserviceimpljava-ver-todo&quot;&gt;ReportsServiceImpl.java &lt;a href=&quot;https://github.com/wearearima/time-report-app/blob/feature/01_tests_for_project_requirements/src/main/java/eu/arima/tr/reports/ReportsServiceImpl.java&quot; target=&quot;_blank&quot;&gt;ver todo&lt;/a&gt;&lt;/h5&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;DayStatusSummary&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;getDayStatusSummaryForWorkerAndDay&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;workerUserName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;LocalDate&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;date&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nc&quot;&gt;DayStatusSummary&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;DayStatusSummary&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setDate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;date&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setWorkerUserName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;workerUserName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

  &lt;span class=&quot;nc&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Worklog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;worklogsForDay&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;worklogRepository&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;findByUsernameAndDate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;workerUserName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;date&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;totalDuration&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Worklog&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;worklog&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;worklogsForDay&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;totalDuration&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;totalDuration&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;worklog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getDuration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;totalDuration&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getStatusList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;DayStatus&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;RIGHT_HOURS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;totalDuration&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getStatusList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;DayStatus&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;EXTRA_HOURS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;totalDuration&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getStatusList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;DayStatus&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;MISSING_HOURS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Vamos a ver un ejemplo de tests que entreg√°bamos por aquel entonces:&lt;/p&gt;

&lt;h5 id=&quot;getdaystatussummaryforworkeranddaytestsjava-ver-todo&quot;&gt;GetDayStatusSummaryForWorkerAndDayTests.java &lt;a href=&quot;https://github.com/wearearima/time-report-app/blob/92fd1b537de787bc2a5d10dc85c9ee80295350d8/src/test/java/eu/arima/tr/reports/reportsServiceImpl/GetDayStatusSummaryForWorkerAndDayTests.java&quot; target=&quot;_blank&quot;&gt;ver todo&lt;/a&gt;&lt;/h5&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nd&quot;&gt;@Test&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_status_summary_for_worker_and_day&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;reportsService&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getDayStatusSummaryForWorkerAndDay&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;USU&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;LocalDate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;assertTrue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;nd&quot;&gt;@Test&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;calculates_the_status_based_on_worker_and_date_worklogs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nc&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Worklog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;partes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ArrayList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Worklog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;();&lt;/span&gt;
  &lt;span class=&quot;nc&quot;&gt;Worklog&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Worklog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;wl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setFromTime&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;LocalTime&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;of&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;wl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setToTime&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;LocalTime&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;of&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;19&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;partes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nc&quot;&gt;Mockito&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;when&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;worklogRepository&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;findByUsernameAndDate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;ArgumentMatchers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;anyString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ArgumentMatchers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;LocalDate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;thenReturn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;partes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

  &lt;span class=&quot;nc&quot;&gt;LocalDate&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fecha&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;LocalDate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;reportsService&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getDayStatusSummaryForWorkerAndDay&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;USU&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fecha&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

  &lt;span class=&quot;nc&quot;&gt;Mockito&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;verify&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;worklogRepository&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;findByUsernameAndDate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;USU&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fecha&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Hemos configurado &lt;a href=&quot;https://www.eclemma.org/jacoco/&quot; target=&quot;_blank&quot;&gt;JaCoCo&lt;/a&gt; para obtener el informe de la cobertura de nuestros tests, y el resultado ha sido el siguiente.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/2020-05-12-mutation-testing/01jacocoreport.png&quot; alt=&quot;JaCoCo report general&quot; class=&quot;center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Tenemos una cobertura de un 92% de l√≠neas y 87% de ramas: objetivo cumplido. Pero‚Ä¶si nos fijamos: el primer test no fallar√° (casi) nunca porque siempre termina con &lt;code class=&quot;highlighter-rouge&quot;&gt;assert true&lt;/code&gt;, el segundo es un poco ‚Äúm√°s completo‚Äù porque al menos est√° verificando que se recuperan los partes‚Ä¶ &lt;sup id=&quot;fnref:1&quot;&gt;&lt;a href=&quot;#fn:1&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;

&lt;p&gt;Pues esta era mi realidad, y mucho me temo que LA realidad, de aquella √©poca en muchos proyectos (y quien sabe si en algunos de hoy en d√≠a). Los proyectos cumpl√≠an los requerimientos de cobertura de c√≥digo, lo que distaba mucho de tener un software de calidad.&lt;/p&gt;

&lt;p&gt;Es cierto que el ejemplo que he puesto es extremo, pero es real. En mi opini√≥n, el problema est√° en el enfoque: se ha dado la vuelta a la tortilla y en √©l los tests nacen como una mera herramienta para asegurar uno de los requerimientos del proyecto.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;% cobertura m√≠nimo por requerimiento ‚Üí test = ‚Äúp√©rdida de tiempo‚Äù&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Volvamos al enfoque original. Quedar√≠a:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Software de calidad ‚Üí c√≥digo de calidad ‚Üí tests de calidad ‚Üí % cobertura de c√≥digo&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;En este escenario, los tests nacen bajo la premisa de tener un c√≥digo de mayor calidad y el % de cobertura se convierte en un indicador m√°s. Vamos a ver un fragmento de un ejemplo de test mejor, de esos de los que hacemos por convicci√≥n y no por cumplir un requerimiento sin m√°s (supongo que m√°s parecidos a los que podemos encontrarnos en los proyectos actuales que los anteriores‚Ä¶).&lt;/p&gt;

&lt;h5 id=&quot;getdaystatussummaryforworkeranddaytestsjava-ver-todo-1&quot;&gt;GetDayStatusSummaryForWorkerAndDayTests.java &lt;a href=&quot;https://github.com/wearearima/time-report-app/blob/feature/02_tests_for_testing_purposes/src/test/java/eu/arima/tr/reports/reportsServiceImpl/GetDayStatusSummaryForWorkerAndDayTests.java&quot; target=&quot;_blank&quot;&gt;ver todo&lt;/a&gt;&lt;/h5&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nd&quot;&gt;@Test&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;if_the_worklog_for_the_resquested_day_is_less_than_8_hours_the_status_is_MISSING_HOURS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nc&quot;&gt;Worklog&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;worklog&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Mockito&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;mock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Worklog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nc&quot;&gt;Mockito&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;when&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;worklog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getDuration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;thenReturn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nc&quot;&gt;Mockito&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;when&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;worklogRepository&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;findByUsernameAndDate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;ArgumentMatchers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;anyString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ArgumentMatchers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;LocalDate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;thenReturn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Arrays&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;asList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;worklog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;

  &lt;span class=&quot;nc&quot;&gt;DayStatusSummary&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resultado&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reportsService&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getDayStatusSummaryForWorkerAndDay&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;USU&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;LocalDate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;assertEquals&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;DayStatus&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;MISSING_HOURS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resultado&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getStatusList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;nd&quot;&gt;@Test&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;if_the_worklog_for_the_resquested_day_is_equal_to_8_hours_the_status_is_RIGHT_HOURS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nc&quot;&gt;Worklog&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;worklog&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Mockito&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;mock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Worklog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nc&quot;&gt;Mockito&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;when&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;worklog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getDuration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;thenReturn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nc&quot;&gt;Mockito&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;when&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;worklogRepository&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;findByUsernameAndDate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;ArgumentMatchers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;anyString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ArgumentMatchers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;LocalDate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;thenReturn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Arrays&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;asList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;worklog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;

  &lt;span class=&quot;nc&quot;&gt;DayStatusSummary&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resultado&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reportsService&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getDayStatusSummaryForWorkerAndDay&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;USU&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;LocalDate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;assertEquals&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;DayStatus&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;RIGHT_HOURS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resultado&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getStatusList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;nd&quot;&gt;@Test&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;if_the_worklog_for_the_resquested_day_is_more_than_8_hours_the_status_is_EXTRA_HOURS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nc&quot;&gt;Worklog&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;worklog&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Mockito&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;mock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Worklog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nc&quot;&gt;Mockito&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;when&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;worklog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getDuration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;thenReturn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nc&quot;&gt;Mockito&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;when&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;worklogRepository&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;findByUsernameAndDate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;ArgumentMatchers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;anyString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ArgumentMatchers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;LocalDate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;thenReturn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Arrays&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;asList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;worklog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;

  &lt;span class=&quot;nc&quot;&gt;DayStatusSummary&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resultado&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reportsService&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getDayStatusSummaryForWorkerAndDay&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;USU&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;LocalDate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;assertEquals&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;DayStatus&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;EXTRA_HOURS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resultado&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getStatusList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;En este caso el porcentaje de cobertura es del 100% de l√≠neas de c√≥digo y ramas. Y adem√°s parece que los tests ya tienen m√°s sentido. Ahora ya s√≠, nos sentir√≠amos seguros con ellos, ¬øverdad? Es as√≠, o ¬øes s√≥lo una percepci√≥n?&lt;/p&gt;

&lt;p&gt;Si alguien modificase algo del m√©todo, por su puesto, antes de comitear y pushear pasar√≠a los tests. Si no hubiese ning√∫n test en rojo, v√≠a libre: no se ha ‚Äúroto‚Äù nada.&lt;/p&gt;

&lt;p&gt;¬øSeguro?&lt;/p&gt;

&lt;p&gt;Supongamos que lo que se modifica en el m√©todo de ejemplo es:&lt;/p&gt;

&lt;h5 id=&quot;reportsserviceimpljava&quot;&gt;ReportsServiceImpl.java&lt;/h5&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Worklog&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;worklog&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;worklogsForDay&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;totalDuration&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;totalDuration&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;worklog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getDuration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;por&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Worklog&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;worklog&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;worklogsForDay&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;totalDuration&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;worklog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getDuration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Nuestros tests seguir√°n pasando&lt;sup id=&quot;fnref:2&quot;&gt;&lt;a href=&quot;#fn:2&quot; class=&quot;footnote&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;. Adem√°s seguimos con un % de cobertura alto‚Ä¶ ¬°Todo perfecto!&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Test ‚Üí &lt;strong&gt;sensaci√≥n&lt;/strong&gt; de seguridad&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;mutation-testing-systems-asegurando-el-camino&quot;&gt;Mutation testing systems: asegurando el camino&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Because we can‚Äôt write perfect software, it follows that we can‚Äôt write perfect test software either. We need to test the tests.&lt;/strong&gt;&lt;/p&gt;
  &lt;p align=&quot;right&quot;&gt;&lt;strong&gt;The Pragmatic Programmer.&lt;/strong&gt; Chapter 8: Pragmatic projects&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Parece que los tests que hemos creado no son tan buenos como cre√≠amos, no tienen calidad suficiente como para asegurar la calidad (valga la redundancia) de nuestro m√©todo. Nos han ofrecido una falsa sensaci√≥n de seguridad.&lt;/p&gt;

&lt;p&gt;Est√° claro que conseguir % altos de cobertura no es sencillo y si escribir tests es costoso, escribir buenos tests lo es a√∫n m√°s y lo que obtenemos es una sensaci√≥n de seguridad que no es real. ¬øNo podr√≠amos hacer que esta sensaci√≥n fuese m√°s cercana a la realidad? ¬øNo podr√≠amos detectar situaciones, como la que hemos visto, de forma autom√°tica?&lt;/p&gt;

&lt;p&gt;Pues bien, para abordar este tipo de situaciones surgen los denominados &lt;em&gt;Mutation Testing Systems&lt;/em&gt;. La idea que hay detr√°s de ellos no es otra que la que hemos expuesto en el √∫ltimo ejemplo: simular cambios en el c√≥digo fuente que se est√° probando y verificar que efectivamente, alg√∫n test fallar√° tras haber realizado la modificaci√≥n.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Software de calidad ‚Üí c√≥digo de calidad ‚Üí tests de calidad ‚Üí % cobertura mutation tests&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Los conceptos b√°sicos son los siguientes:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Cada cambio que se genera en el c√≥digo es un &lt;strong&gt;mutante&lt;/strong&gt; (mutant).&lt;/li&gt;
  &lt;li&gt;Cada cambio (o mutante) que nuestros tests son capaces de detectar se denomina &lt;strong&gt;matar un mutante&lt;/strong&gt; (killed mutant).&lt;/li&gt;
  &lt;li&gt;Cada cambio (o muntante) que nuestros tests no son capaces de detectar son &lt;strong&gt;mutantes vivos&lt;/strong&gt; (survived mutant).&lt;/li&gt;
  &lt;li&gt;Los cambios en el c√≥digo se generan mediante &lt;strong&gt;operadores mutantes&lt;/strong&gt; (mutators / mutation operators), que se agrupan en diferentes categorias dependiendo del tipo de cambio que realicen en el c√≥digo.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Personalmente no hab√≠a o√≠do hablar de este concepto hasta hace relativamente poco sin embargo, la realidad es que ya llevan varios a√±os entre nosotros. Existen m√∫ltiples alternativas para los diferentes stacks tecnol√≥gicos. Por ejemplo:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://stryker-mutator.io/&quot; target=&quot;_blank&quot;&gt;Stryker&lt;/a&gt; para JavaScript, TypeScript, C# y Scala&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://thesoftwaredesignlab.github.io/mutode/&quot; target=&quot;_blank&quot;&gt;Mutode&lt;/a&gt; para JavaScript y Node.js&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://cosmic-ray.readthedocs.io/en/latest/&quot; target=&quot;_blank&quot;&gt;Cosmic Ray&lt;/a&gt; para Python&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://pypi.org/project/mutmut/&quot; target=&quot;_blank&quot;&gt;mutmut&lt;/a&gt; para Python&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/mbj/mutant&quot; target=&quot;_blank&quot;&gt;Mutant&lt;/a&gt; para Ruby&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Y volviendo a Java algunos de los sistemas de mutaci√≥n son (o han sido):&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://pitest.org/&quot; target=&quot;_blank&quot;&gt;PIT&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://jumble.sourceforge.net/index.html&quot; target=&quot;_blank&quot;&gt;Jumble&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://jester.sourceforge.net/&quot; target=&quot;_blank&quot;&gt;Jester&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/jeffoffutt/muJava&quot; target=&quot;_blank&quot;&gt;muJava&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Nosotros hemos utilizado PIT porque:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Es sencillo de usar&lt;/li&gt;
  &lt;li&gt;Se integra f√°cilmente en los proyectos que los hemos usado (mediante un plugin de maven) as√≠ como en el IDE (en nuestro caso Eclipse)&lt;/li&gt;
  &lt;li&gt;Admite diferentes configuraciones (algunas que permiten mejorar la eficiencia)&lt;/li&gt;
  &lt;li&gt;A√∫n est√° activo&lt;/li&gt;
  &lt;li&gt;Parece ser la soluci√≥n m√°s utilizada en la actualidad&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Si ejecutamos el informe de &lt;em&gt;pitest&lt;/em&gt; en nuestro ejemplo, veremos este resultado.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/2020-05-12-mutation-testing/PitTestCoverageReport01.png&quot; alt=&quot;Informe _Pit test_ general&quot; class=&quot;center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Aqu√≠ se indica el resultado general: por un lado la cobertura de l√≠neas de c√≥digo y por otro lado la cobertura de mutaci√≥n.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/2020-05-12-mutation-testing/PitTestCoverageReportClass01.png&quot; alt=&quot;Informe _Pit test_ clase&quot; class=&quot;center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Las l√≠neas marcadas en verde, reflejan c√≥digo en el que PIT ha introducido cambios y los tests han sido capaces de detectarlo. Las l√≠neas marcadas en rojo, reflejan las l√≠neas de c√≥digo que nuestros tests no han sabido detectar que hab√≠a habido cambios. Si nos fijamos la l√≠nea 27 es la que nosotros hab√≠amos modificado y nuestros tests hab√≠an pasado. Ahora tenemos dos opciones: seguir adelante, asumiendo la fragilidad que puede tener nuestro c√≥digo o lo m√°s acertado (y l√≥gico) a√±adir/corregir tests que nos aseguren la fiabilidad frente a los cambios detectados.&lt;/p&gt;

&lt;p&gt;En el siguiente &lt;a href=&quot;https://github.com/wearearima/time-report-app/tree/feature/03_tests_improving_quality&quot; target=&quot;_blank&quot;&gt;enlace&lt;/a&gt; est√° disponible el c√≥digo del ejemplo en el que hemos trabajado, donde hemos mejorado los tests para conseguir una mayor cobertura de mutantes.&lt;/p&gt;

&lt;p&gt;Los mutantes que se aplican son configurables, y hay que valorar el equilibrio entre la cantidad/tipo de mutantes configurados y el tiempo de ejecuci√≥n. A mayor n√∫mero de tests, mayor n√∫mero de l√≠neas de c√≥digo y mayor cantidad de mutantes, m√°s tiempo necesitar√° Pit en generar el informe correspondiente. Puede llegar un momento en el que sea tan costoso pasar el informe que se hagamos skip, y entonces todo el esfuerzo dedicado a testing se desvanecer√≠a. En los ejemplos hemos visto s√≥lo tests unitarios pero lo mismo aplica a los test de integraci√≥n (muchos de ellos ya costosos en s√≠ mismos).&lt;/p&gt;

&lt;p&gt;En nuestro caso, solemos configurar los que vienen por defecto (DEFAULTS) y a√±adiendo los del siguiente grupo (NEW_DEFAULTS). En el c√≥digo de ejemplo hay alguno m√°s configurado, pero &lt;a href=&quot;https://pitest.org/quickstart/mutators/&quot; target=&quot;_blank&quot;&gt;aqu√≠&lt;/a&gt; se muestran los ‚Äúmutadores‚Äù (mutators) de Pit, as√≠ que prueba a cambiar la configuraci√≥n y a ver los diferentes resultados.&lt;/p&gt;

&lt;h2 id=&quot;conclusiones&quot;&gt;Conclusiones&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;p&gt;Software de calidad ‚Üí c√≥digo de calidad ‚Üí tests de calidad&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Software de calidad require de c√≥digo calidad que a su vez puede validarse gracias a tests de calidad.&lt;/p&gt;

&lt;p&gt;Generalmente hay m√°s c√≥digo para testear un m√©todo que para implementarlo, lo que conlleva un claro esfuerzo en tiempo: dedicaremos m√°s tiempo al testeo de un m√©todo que a su implementaci√≥n. Necesitamos asegurar que dicho esfuerzo no sea en balde.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Mutation testing&lt;/strong&gt; es una herramienta que nos permite evaluar y mejorar la calidad de nuestros tests. El precio a pagar es el aumento de tiempo necesario para pasarlos. Teniendo en cuenta que se basa en mutaciones de c√≥digo y que aplica no s√≥lo a tests unitarios, tambi√©n a tests de integraci√≥n, a medida que el c√≥digo crezca y el n√∫mero de tests aumente, mayor ser√° el tiempo necesario para ejecutarlos. Es necesario, por tanto, buscar f√≥rmulas que aseguren que en alguna fase de nuestro desarrollo todos los tests pasan: si dejamos de pasarlos porque es demasiado costoso todo el esfuerzo habr√° sido en vano.&lt;/p&gt;

&lt;p&gt;Hemos dado un paso firme, pero nos queda recorrido en nuestro camino hacia la calidad: ¬øQu√© podemos hacer para buscar este equilibrio? ¬øPodemos organizar de alguna forma los tests para facilitarlo? ¬øHay herramientas que nos permitan desarrollar/ejecutar tests de forma m√°s eficiente?&lt;/p&gt;
&lt;div class=&quot;footnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:1&quot;&gt;
      &lt;p&gt;Si quieres probar todo esto puedes descargarte el c√≥digo de &lt;a href=&quot;https://github.com/wearearima/time-report-app/tree/feature/01_tests_for_project_requirements&quot; target=&quot;_blank&quot;&gt;aqu√≠&lt;/a&gt;¬†&lt;a href=&quot;#fnref:1&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:2&quot;&gt;
      &lt;p&gt;Pru√©balo tu mismo, el c√≥digo est√° disponible &lt;a href=&quot;https://github.com/wearearima/time-report-app/tree/feature/02_tests_for_testing_purposes&quot; target=&quot;_blank&quot;&gt;aqu√≠&lt;/a&gt;¬†&lt;a href=&quot;#fnref:2&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;</content><author><name>jessica</name></author><category term="testing," /><category term="mutation" /><category term="testing" /><category term="systems," /><category term="pit," /><category term="pitest," /><category term="calidad," /><category term="software" /><category term="quality," /><category term="QA," /><category term="cobertura," /><category term="coverage," /><category term="junit" /><summary type="html">Profesionalmente me etiqueto como desarrolladora, aunque no me gustan mucho las etiquetas y me gusta m√°s decir que la raz√≥n de ser de mi trabajo es: crear software de calidad. Pero ¬øqu√© es software de calidad? A mi me gusta definirlo como sigue:</summary></entry><entry xml:lang="es"><title type="html">C√≥mo prepar√© y aprob√© el Certified Kubernetes Application Developer (CKAD)</title><link href="https://blog.arima.eu/es/2020/04/28/examen-ckad.html" rel="alternate" type="text/html" title="C√≥mo prepar√© y aprob√© el Certified Kubernetes Application Developer (CKAD)" /><published>2020-04-28T06:00:00+00:00</published><updated>2020-04-28T06:00:00+00:00</updated><id>https://blog.arima.eu/2020/04/28/examen-ckad</id><content type="html" xml:base="https://blog.arima.eu/2020/04/28/examen-ckad.html">&lt;p&gt;En este post voy a explicar un poco mi experiencia de c√≥mo prepar√© y aprob√© el Certified Kubernetes Application Developer (CKAD).&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.linuxfoundation.org/&quot; target=&quot;_blank&quot;&gt;The Linux Foundation&lt;/a&gt; y &lt;a href=&quot;https://www.cncf.io/&quot; target=&quot;_blank&quot;&gt;Cloud Native Computing Foundation&lt;/a&gt; 
ofrecen dos variantes en la certificaci√≥n de Kubernetes, CKAD y CKA. En pocas palabras:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://www.cncf.io/certification/ckad/&quot; target=&quot;_blank&quot;&gt;CKAD&lt;/a&gt; est√° dise√±ado para desarrolladores de software que deseen desarrollar e implementar sus aplicaciones en Kubernetes.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://www.cncf.io/certification/cka/&quot; target=&quot;_blank&quot;&gt;CKA&lt;/a&gt; est√° dise√±ado para los administradores de sistemas que administran los cl√∫steres de Kubernetes.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;En general, CKA cubre un temario m√°s amplio que CKAD. Puedes ver informaci√≥n sobre las similitudes y diferencias entre los dos ex√°menes &lt;a href=&quot;https://medium.com/faun/cka-vs-ckad-1dd45527505&quot; target=&quot;_blank&quot;&gt;aqu√≠&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/2020-04-22-examen-ckad/ckad-cka.png&quot; alt=&quot;CKAD / CKA&quot; class=&quot;center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Como he dicho, CKAD es uno de los dos programas dise√±ados por la CNCF y The Linux Foundation para certificar a los usuarios que pueden ‚Äúdise√±ar, construir, configurar y exponer aplicaciones nativas en la nube para Kubernetes‚Äù.&lt;/p&gt;

&lt;p&gt;Si eres un desarrollador que usas la infraestructura centrada en Kubernetes a diario, CKAD es un gran m√©todo para medir tus habilidades con los √∫ltimos est√°ndares de la industria.&lt;/p&gt;

&lt;p&gt;Cabe destacar que Kubernetes es una herramienta con la que yo ya hab√≠a trabajado con anterioridad y por lo tanto, estaba familiarizado con la mayor√≠a de conceptos.&lt;/p&gt;

&lt;h2 id=&quot;por-qu√©-deber√≠as-hacer-este-examen&quot;&gt;¬øPor qu√© deber√≠as hacer este examen?&lt;/h2&gt;

&lt;p&gt;A pesar de que en &lt;a href=&quot;https://arima.eu/&quot; target=&quot;_blank&quot;&gt;ARIMA&lt;/a&gt; por lo general no somos muy partidarios de medir los conocimientos de las personas u organizaciones en funci√≥n de los certificados que puedan poseer, hay ocasiones en las que disponer de un certificado emitido por un tercero s√≠ que puede ayudar como carta de presentaci√≥n a la hora de ofrecer soluciones que giran en torno a una herramienta como Kubernetes. M√°s a√∫n cuando se trata de una organizaci√≥n del prestigio de la CNCF y de un certificado que tiene un cierto grado de dificultad como puede ser el CKAD.&lt;/p&gt;

&lt;h2 id=&quot;prerequisitos&quot;&gt;Prerequisitos&lt;/h2&gt;

&lt;p&gt;No hay prequisitos oficiales para este examen, pero recomiendo tener experiencia pr√°ctica en &lt;strong&gt;Docker&lt;/strong&gt; y &lt;strong&gt;Linux&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;Al trabajarse constantemente con contenedores, uno debe comprender qu√© es una imagen de Docker, c√≥mo ejecutar los contenedores, extraer y trabajar con im√°genes, etc.&lt;/p&gt;

&lt;p&gt;Linux tambi√©n es esencial para este examen, ya que el examen al ser 100% pr√°ctico necesitas tener bastante agilidad a la hora de editar ficheros, cambiar permisos, ejecutar comandos, etc.&lt;/p&gt;

&lt;h2 id=&quot;sobre-el-examen&quot;&gt;Sobre el examen&lt;/h2&gt;

&lt;p&gt;Este es un examen &lt;strong&gt;totalmente pr√°ctico&lt;/strong&gt;, no tiene preguntas de opci√≥n m√∫ltiple.&lt;/p&gt;

&lt;p&gt;Se te dar√° un conjunto de problemas que tienes que ir solventando desde una l√≠nea de comandos desplegada en una aplicaci√≥n web y se espera que tardes aproximadamente dos horas en completarlo.&lt;/p&gt;

&lt;p&gt;Debes resolver &lt;strong&gt;19 preguntas&lt;/strong&gt; en &lt;strong&gt;2 horas&lt;/strong&gt; y cada pregunta tiene un valor diferente, desde &lt;strong&gt;2% a 13%&lt;/strong&gt;, pero la mayor√≠a de las preguntas est√°n entre &lt;strong&gt;8% y 5%&lt;/strong&gt;. La puntuaci√≥n no corresponde al nivel de dificultad.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Para aprobar el examen es necesario sacar al menos el 66%.&lt;/strong&gt; En mi caso, consegu√≠ un 88% en el primer intento y me dio tiempo justo a acabar las 19 preguntas a pesar de que fui bastante r√°pido en la resoluci√≥n de los problemas. &lt;strong&gt;El tiempo es todo en este examen.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;El precio de este examen es de &lt;strong&gt;$300 USD&lt;/strong&gt;, y dispones de otro intento gratuito si suspendes el examen. El examen incluye preguntas de los siguientes temas:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Core Concepts (13%)&lt;/li&gt;
  &lt;li&gt;Configuration (18%)&lt;/li&gt;
  &lt;li&gt;Multi-Container Pods (10%)&lt;/li&gt;
  &lt;li&gt;Observability (18%)&lt;/li&gt;
  &lt;li&gt;Pod Design (20%)&lt;/li&gt;
  &lt;li&gt;Services &amp;amp; Networking (13%)&lt;/li&gt;
  &lt;li&gt;State Persistence (8%)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;En el examen, se te proporcionan &lt;strong&gt;4 cl√∫steres&lt;/strong&gt; por los cuales tendr√°s que ir trabajando hasta completar todos los ejercicios. El sistema operativo que usan es un &lt;strong&gt;Ubuntu 16.04&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/2020-04-22-examen-ckad/clusters.png&quot; alt=&quot;Clusters&quot; class=&quot;center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Al comienzo de cada pregunta, se te proporciona el comando que debes ejecutar para ir al cl√∫ster en concreto. Por ejemplo:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ kubectl config use-context k8s
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;tipos-de-preguntas&quot;&gt;Tipos de preguntas&lt;/h3&gt;

&lt;p&gt;Las preguntas van desde preguntas relativamente cortas, como las que aparecen en la lista de  &lt;a href=&quot;https://github.com/dgkanatsios/CKAD-exercises&quot; target=&quot;_blank&quot;&gt;ejercicios CKAD de Dgkanatsios&lt;/a&gt;, hasta preguntas m√°s largas de unas 6 o 7 l√≠neas.&lt;/p&gt;

&lt;p&gt;Tienes que sentirte c√≥modo creando &lt;em&gt;pods&lt;/em&gt;, &lt;em&gt;developments&lt;/em&gt;, &lt;em&gt;jobs&lt;/em&gt;, &lt;em&gt;cronjobs&lt;/em&gt;, &lt;em&gt;services&lt;/em&gt;, etc. Tambi√©n habr√° ejercicios de &lt;em&gt;rolling updates&lt;/em&gt; and &lt;em&gt;rollbacks&lt;/em&gt;. B√°sicamente preguntan todo el temario que entra en el examen.&lt;/p&gt;

&lt;h3 id=&quot;recursos-oficiales-del-examen&quot;&gt;Recursos oficiales del examen&lt;/h3&gt;

&lt;p&gt;Estos son los recursos que la propia CNCF pone a disposici√≥n de los estudiantes:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Certified Kubernetes Application Developer: &lt;a href=&quot;https://www.cncf.io/certification/ckad/&quot; target=&quot;_blank&quot;&gt;https://www.cncf.io/certification/ckad/&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;Curriculum Overview: &lt;a href=&quot;https://github.com/cncf/curriculum&quot; target=&quot;_blank&quot;&gt;https://github.com/cncf/curriculum&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;Candidate Handbook: &lt;a href=&quot;https://training.linuxfoundation.org/go/cka-ckad-candidate-handbook&quot; target=&quot;_blank&quot;&gt;https://training.linuxfoundation.org/go/cka-ckad-candidate-handbook)&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;Exam Tips: &lt;a href=&quot;http://training.linuxfoundation.org/go/Important-Tips-CKA-CKAD&quot; target=&quot;_blank&quot;&gt;http://training.linuxfoundation.org/go/Important-Tips-CKA-CKAD&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;FAQ: &lt;a href=&quot;http://training.linuxfoundation.org/go/cka-ckad-faq&quot; target=&quot;_blank&quot;&gt;http://training.linuxfoundation.org/go/cka-ckad-faq&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;d√≥nde-registrarse&quot;&gt;D√≥nde registrarse&lt;/h3&gt;

&lt;p&gt;Primero deber√°s registrarte en &lt;strong&gt;The Linux Foundation&lt;/strong&gt; desde &lt;a href=&quot;https://identity.linuxfoundation.org/user/login&quot; target=&quot;_blank&quot;&gt;aqu√≠&lt;/a&gt;. Despu√©s, podr√°s registrarte para el examen desde &lt;a href=&quot;https://identity.linuxfoundation.org/pid/813&quot; target=&quot;_blank&quot;&gt;aqu√≠&lt;/a&gt;, donde se te mostrar√° la siguiente pantalla:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/2020-04-22-examen-ckad/checkout.png&quot; alt=&quot;Checkout&quot; class=&quot;center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Una vez que hayas hecho el pago para el examen, recibir√°s un correo electr√≥nico y podr√°s iniciar sesi√≥n desde &lt;a href=&quot;https://training.cncf.io/portal&quot; target=&quot;_blank&quot;&gt;este&lt;/a&gt; enlace al portal donde debes seguir una serie de pasos antes de programar y hacer el examen, tales  como verificar los requisitos de tu m√°quina, leer informaci√≥n importante sobre el examen, etc.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/2020-04-22-examen-ckad/cncf-checklist.png&quot; alt=&quot;Checkout&quot; class=&quot;center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;c√≥mo-preparar-el-examen&quot;&gt;C√≥mo preparar el examen&lt;/h2&gt;

&lt;h3 id=&quot;cursos&quot;&gt;Cursos&lt;/h3&gt;

&lt;p&gt;Como he dicho antes, de cara a prepararme el examen realic√© los dos siguientes cursos de &lt;a href=&quot;https://www.udemy.com/&quot; target=&quot;_blank&quot;&gt;Udemy&lt;/a&gt;:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.udemy.com/course/learn-kubernetes/&quot; target=&quot;_blank&quot;&gt;Kubernetes for the Absolute Beginners - Hands-on&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.udemy.com/course/certified-kubernetes-application-developer/&quot; target=&quot;_blank&quot;&gt;Kubernetes Certified Application Developer (CKAD) with Tests&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;El primero, aunque ya ten√≠a nociones b√°sicas de Kubernetes, lo realic√© para comprobar que mi base en Kubernetes era la adecuada. No aprend√≠ practicamente nada nuevo en ese curso, por lo que si eres una persona que ya ha trabajado con Kubernetes yo pasar√≠a directamente al segundo. Adem√°s, en el segundo curso, hacen repaso de los conceptos m√°s importantes que se dan en el primero.&lt;/p&gt;

&lt;p&gt;El segundo curso me aport√≥ mucho m√°s, ya que est√° centrado en el examen en s√≠, y los ejercicios pr√°cticos que tiene son muy buenos. El entorno de pruebas es muy potente (parecido al que te vas a encontrar en el examen), me ayud√≥ mucho a mejorar la velocidad con la que solventaba los problemas.&lt;/p&gt;

&lt;h3 id=&quot;ejercicios-para-practicar&quot;&gt;Ejercicios para practicar&lt;/h3&gt;

&lt;p&gt;B√°sicamente estos fueron los recursos que use para preparar el examen a parte de los del propio curso, alguno lo hice entero entre 2 y 3 veces, al final tienes que coger la habilidad de poder leer la pregunta y sin dudar un segundo, saber c√≥mo resolver el problema, ya que como repito el tiempo es todo en este examen.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/bmuschko/ckad-prep&quot; target=&quot;_blank&quot;&gt;https://github.com/bmuschko/ckad-prep&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/dgkanatsios/CKAD-exercises&quot; target=&quot;_blank&quot;&gt;https://github.com/dgkanatsios/CKAD-exercises&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://codeburst.io/kubernetes-ckad-weekly-challenges-overview-and-tips-7282b36a2681&quot; target=&quot;_blank&quot;&gt;https://codeburst.io/kubernetes-ckad-weekly-challenges-overview-and-tips-7282b36a2681&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;En total, entre realizar los dos cursos, estudiar y hacer los ejercicios pr√°cticos habr√© dedicado unas &lt;strong&gt;90 horas&lt;/strong&gt; para aprobar el examen. Empec√© a prepararlo un 30 de marzo e hice el examen el 15 de abril.&lt;/p&gt;

&lt;h2 id=&quot;consejos-y-trucos-√∫tiles&quot;&gt;Consejos y trucos √∫tiles&lt;/h2&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;S√© r√°pido y preciso. Es un examen muy largo y con poco tiempo.&lt;/strong&gt; No esperes poder responder con tranquilidad todas las preguntas en 120 minutos, no da tiempo, ni siquiera a repasar.&lt;/p&gt;

    &lt;p&gt;Lo que hice yo en el examen fue que si ve√≠a que la pregunta ten√≠a un valor &amp;lt; 3% y el enunciado era muy largo, las dejaba para el final y volv√≠ a ellas tras haber completado la mayor√≠a de las preguntas. Si te quedas atascado, pasa de pregunta, tienes que lograr responder a las m√°ximas preguntas posibles.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Cuando est√©s creando recursos en el cl√∫ster, &lt;strong&gt;no escribas archivos YAML desde el principio&lt;/strong&gt;. Usa los argumentos &lt;code class=&quot;highlighter-rouge&quot;&gt;-o yaml --dry-run&lt;/code&gt; siempre que puedas. Si todav√≠a no sabes lo que es, ya est√°s tardando en aprenderlo!&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Si no recuerdas alguna sintaxis al escribir archivos YAML, utiliza &lt;code class=&quot;highlighter-rouge&quot;&gt;kubectl explain&lt;/code&gt; en lugar de la documentaci√≥n. Es m√°s r√°pido y tiene buena documentaci√≥n. Te recomiendo que lo practiques para que te vaya saliendo solo.&lt;/p&gt;

    &lt;p&gt;Por ejemplo, si no recuerdas las opciones de &lt;code class=&quot;highlighter-rouge&quot;&gt;livenessProbe&lt;/code&gt; para el contenedor, simplemente escribe &lt;code class=&quot;highlighter-rouge&quot;&gt;kubectl explain pod.spec.containers.livenessProbe&lt;/code&gt; y te dar√° todas las opciones con una buena documentaci√≥n.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Usa siempre alias, tanto en tu entrenamiento como en el examen, te ahorran tiempo, estos fueron los que us√© yo en el examen:&lt;/p&gt;

    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; alias k=kubectl
 alias ks='kubectl config set-context --current --namespace '
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Elimina los objetos de Kubernetes r√°pidamente&lt;/strong&gt;. Eliminar los objetos en Kubernetes a veces tarda hasta 30 segundos debido a que tiene un periodo de gracia, en el examen no te interesa que lo haga as√≠, lo mejor es que siempre fuerces la eliminaci√≥n del recurso.&lt;/p&gt;

    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; $ kubectl delete pod nginx --grace-period=0 --force
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Aseg√∫rate que est√°s en el contexto y namespace adeacuados&lt;/strong&gt;. Vas a tener que estar cambiando de contexto y de namespace constantemente, yo en el examen perd√≠ la cuenta de cuantas veces lo hice, pero es muy importante asegurarse que siempre est√°s en el cl√∫ster y namespace correctos.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;¬°Usa los marcadores del navegador!&lt;/strong&gt; Solo tienes permitido tener una pesta√±a extra a la del examen con la documentaci√≥n de Kubernetes, lo que s√≠ permiten son los marcadores. Te dejo &lt;a href=&quot;/assets/extra/2020-04-22-examen-ckad/CKAD-bookmarks.html&quot; target=&quot;_blank&quot;&gt;aqu√≠&lt;/a&gt; los marcadores que cre√© y utilic√© yo en el examen, son enlaces directos a ejemplos que te ayudar√° a resolver los problemas m√°s r√°pido.&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;/assets/images/2020-04-22-examen-ckad/marcadores.png&quot; alt=&quot;Marcadores&quot; class=&quot;center&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;¬°Recuerda hacer clic en el bot√≥n ‚ÄúFinalizar el examen‚Äù!&lt;/strong&gt; Estuve durante cinco minutos sin tocar el teclado pregunt√°ndome por qu√© esto no ha terminado todav√≠a hasta que el supervisor del examen me lo record√≥. El bot√≥n est√° oculto en el men√∫ de configuraci√≥n del examen.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Antes de comenzar el examen, debes &lt;strong&gt;quitar todo lo que tengas encima de la mesa: l√°mpara de escritorio, bebidas, alimentos, etc.&lt;/strong&gt;, posteriormente debes mostrar tu DNI o pasaporte, tu habitaci√≥n y escritorio. Utilic√© una port√°til con un monitor externo, as√≠ que aseg√∫rate de que tus cables sean lo suficientemente largos o descon√©ctalos por completo.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;No te tapes nunca la boca con la mano o murmures porque el examinador te lo recriminar√° y al menos a m√≠ me desconcentr√≥.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Usa la misma versi√≥n de &lt;strong&gt;Kubectl&lt;/strong&gt; y de &lt;strong&gt;Kubernetes&lt;/strong&gt; que el examen. En mi caso fue la versi√≥n 1.17. Al usar &lt;code class=&quot;highlighter-rouge&quot;&gt;Minikube for Mac OS&lt;/code&gt; en local, cambiar la versi√≥n de Kuberenetes es muy sencillo:&lt;/p&gt;

    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;minikube start --kubernetes-version v1.17.0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Tambi√©n se permite el &lt;strong&gt;uso de m√∫ltiples monitores&lt;/strong&gt;, yo ten√≠a la documentaci√≥n de Kubernetes en un monitor y examen en el otro monitor. Me fue de gran utilidad tener de un vistazo ambas pantallas. Eso s√≠, se te pedir√° en el examen que compartas ambas pantallas.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Practica&lt;/strong&gt;. No por ser el √∫ltimo consejo es el menos importante. Practica todo lo que puedas. En el examen lo agradecer√°s.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;resultados&quot;&gt;Resultados&lt;/h2&gt;

&lt;p&gt;Lamentablemente, los resultados no se obtienen de inmediato, tardan hasta 36 horas en darte el resultado. ¬°No sabes que larga se me hizo la espera! Pero finalmente lleg√≥, aqu√≠ estaba el tan ansiado certificado.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/2020-04-22-examen-ckad/certificate.png&quot; alt=&quot;Certificado&quot; class=&quot;center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;conclusi√≥n&quot;&gt;Conclusi√≥n&lt;/h2&gt;

&lt;p&gt;No te voy a enga√±ar, no es un examen f√°cil. Al principio lo ver√°s complicado, pero a medida que vas practicando vas viendo la luz. Tienes que practicar mucho, coger soltura con los comandos &lt;code class=&quot;highlighter-rouge&quot;&gt;kubectl&lt;/code&gt;, editando ficheros con &lt;code class=&quot;highlighter-rouge&quot;&gt;Vim&lt;/code&gt; o &lt;code class=&quot;highlighter-rouge&quot;&gt;Nano&lt;/code&gt;, saber moverte bien por la documentaci√≥n de K8s, etc.&lt;/p&gt;

&lt;p&gt;Me ha parecido una experiencia muy buena para completar mis conocimientos de Kubernetes y estar al d√≠a de lo que est√° ofreciendo la plataforma.&lt;/p&gt;

&lt;p&gt;¬°Buena suerte con tu examen CKAD!&lt;/p&gt;</content><author><name>fernando</name></author><category term="certificaciones," /><category term="examenes," /><category term="Kubernetes," /><category term="CNCF," /><category term="CKAD," /><category term="CKA" /><summary type="html">En este post voy a explicar un poco mi experiencia de c√≥mo prepar√© y aprob√© el Certified Kubernetes Application Developer (CKAD).</summary></entry><entry xml:lang="es"><title type="html">Buenas pr√°cticas para escribir un Dockerfile</title><link href="https://blog.arima.eu/es/2020/04/21/buenas-practicas-para-escribir-un-dockerfile.html" rel="alternate" type="text/html" title="Buenas pr√°cticas para escribir un Dockerfile" /><published>2020-04-21T09:00:00+00:00</published><updated>2020-04-21T09:00:00+00:00</updated><id>https://blog.arima.eu/2020/04/21/buenas-practicas-para-escribir-un-dockerfile</id><content type="html" xml:base="https://blog.arima.eu/2020/04/21/buenas-practicas-para-escribir-un-dockerfile.html">&lt;p&gt;A la hora de escribir un Dockerfile, las posibilidades son infinitas. Se pueden crear im√°genes con el mismo prop√≥sito, que funcionen similar, pero que est√©n estructuradas de una manera muy diferente. Empezando por elegir una imagen de partida (FROM), pasando por el orden de los comandos que ejecutamos al construir la imagen, o creando im√°genes intermedias (&lt;em&gt;multistage builds&lt;/em&gt;), escribir un Dockerfile es un mundo.&lt;/p&gt;

&lt;p&gt;En este documento se recogen algunas de las pautas m√°s importantes que hay que seguir si queremos optimizar al m√°ximo el tiempo que tardamos en crear la imagen, la seguridad de la misma y el tama√±o que ocupa.&lt;/p&gt;

&lt;h3 id=&quot;1-el-orden-de-los-comandos-importa&quot;&gt;1. El orden de los comandos importa&lt;/h3&gt;

&lt;p&gt;Por la manera en la que funciona el cach√© a la hora de construir una imagen, Docker es capaz de detectar si el comando que queremos ejecutar se ha ejecutado antes o no (en una &lt;em&gt;build&lt;/em&gt; anterior) y reutilizar el resultado desde la cach√© para hacerlo m√°s r√°pido. El problema es que, si uno de los comandos ha cambiado, los comandos que le suceden no pueden ser sacados de cach√© porque puede que alguno se haya visto afectado y el resultado sea diferente.&lt;/p&gt;

&lt;p&gt;Es por esto que se recomienda ordenar los comandos seg√∫n la frecuencia que tienen de ser cambiados. Si estuvi√©semos creando una imagen que contiene una aplicaci√≥n, por ejemplo, las modificaciones m√°s comunes ser√≠an las del c√≥digo, las de los recursos ser√≠an las siguientes, y por √∫ltimo ir√≠an las dependencias. Por eso, deber√≠amos ordenarlas en order ascendente para asegurarnos de que optimizamos el uso de cach√©.&lt;/p&gt;

&lt;h3 id=&quot;2-junta-los-comandos-en-capas&quot;&gt;2. Junta los comandos en capas&lt;/h3&gt;

&lt;p&gt;En un Dockerfile, cada comando representa una capa de la imagen final. Es importante juntar las capas que compartan la misma l√≥gica (instalaci√≥n de dependencias, por ejemplo) para mejorar el uso de cach√© y para hacer el Dockerfile m√°s mantenible.&lt;/p&gt;

&lt;p&gt;Sin embargo, hay que tener en cuenta que, si realizamos demasiadas acciones en el mismo comando, si en alg√∫n momento queremos cambiar algo del comando la cach√© ya no servir√° y habr√° que volver a ejecutarlo entero. Por esto, es importante estudiar cada escenario y evaluar cu√°l es la mejor forma de hacerlo.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;MAL&lt;/strong&gt; ‚ùå&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-Dockerfile&quot;&gt;FROM ubuntu
RUN apt update &amp;amp;&amp;amp; apt install openjdk-8-jdk -y
RUN apt update &amp;amp;&amp;amp; apt install vim -y
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;BIEN&lt;/strong&gt; ‚úÖ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-Dockerfile&quot;&gt;FROM ubuntu
RUN apt update &amp;amp;&amp;amp; apt install openjdk-8-jdk vim -y
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&quot;3-elimina-la-cach√©-que-no-necesites&quot;&gt;3. Elimina la cach√© que no necesites&lt;/h3&gt;

&lt;p&gt;La cach√© es buena s√≠, ¬øpero cu√°l? Hay que entender que a la hora de construir una imagen existen dos tipos de cach√©: 1. la que genera docker con las capas de nuestra imagen y 2. la que generan nuestros comandos dentro de la propia imagen. La primera es buena para mejorar el tiempo de construcci√≥n, pero la segunda probablemente no.&lt;/p&gt;

&lt;p&gt;El segundo tipo de cach√© se suele generar al instalar dependencias o durante el proceso de compilaci√≥n de una aplicaci√≥n, y es muy poco probable que vayas a utilizarlo y lo m√°s seguro es que solo est√© ah√≠ ocupando espacio.&lt;/p&gt;

&lt;p&gt;F√≠jate en la √∫ltima l√≠nea del siguiente Dockerfile:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-Dockerfile&quot;&gt;FROM maven:3.6.3-jdk-11
ENTRYPOINT [&quot;java&quot;, &quot;-jar&quot;, &quot;target/*.jar&quot;]
COPY pom.xml .
COPY src ./src
RUN mvn -e -B clean package &amp;amp;&amp;amp; rm -rf /root/.m2
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Tiene que quedar claro que, para borrar un fichero de la imagen, es necesario que el fichero se cree y se borre en el mismo comando. Si se hace en diferentes comandos, el fichero aparentemente habr√° desaparecido, pero seguir√° estando en la &lt;em&gt;layer&lt;/em&gt; en la que lo hemos creado y seguir√° consumiendo espacio.&lt;/p&gt;

&lt;p&gt;Este fichero sigue existiendo:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-Dockerfile&quot;&gt;FROM busybox
RUN touch a
RUN rm a
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Este no:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-Dockerfile&quot;&gt;FROM busybox
RUN touch a &amp;amp;&amp;amp; rm a
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Si el objetivo es reducir el espacio que ocupa la imagen final y no podemos eliminar este tipo de ficheros en el mismo comando en el que lo creamos, podemos utilizar la opci√≥n &lt;code class=&quot;highlighter-rouge&quot;&gt;--squash&lt;/code&gt; a la hora de crear la imagen para juntar todas las capas en una sola, donde s√≠ que eliminar√≠amos el fichero. Pero, !cuidado! La opci√≥n &lt;code class=&quot;highlighter-rouge&quot;&gt;--squash&lt;/code&gt; tiene m√°s implicaciones, como borrar la historia de la imagen, √∫sala solo cuando sea extrictamente necesario.&lt;/p&gt;

&lt;h3 id=&quot;4-elige-bien-la-imagen-base&quot;&gt;4. Elige bien la imagen base&lt;/h3&gt;

&lt;p&gt;A la hora de elegir una imagen desde la que partir, lo primero que se nos puede ocurrir es escoger una imagen que no tenga m√°s que lo b√°sico (un sistema operativo) e instalar encima todo lo que necesitemos. Esto puede funcionar, pero lo que es mucho mejor a nivel de seguridad, mantenibilidad y espacio, es utilizar una imagen de alg√∫n proveedor de confianza que ya nos lo d√© hecho.&lt;/p&gt;

&lt;p&gt;Por ejemplo, supongamos que necesitamos una imagen con Python 3.6 instalado. Podr√≠amos utilizar &lt;code class=&quot;highlighter-rouge&quot;&gt;alpine&lt;/code&gt; como base e instalar Python con el gestor de paquetes, o utilizar la imagen &lt;code class=&quot;highlighter-rouge&quot;&gt;python:3.6-alpine&lt;/code&gt;, que ya trae Python instalado y est√° mantenido por los desarrolladores de Python (adem√°s de otras cosas).&lt;/p&gt;

&lt;p&gt;El exponente que mejor cumple con este punto puede que sea &lt;a href=&quot;https://github.com/GoogleContainerTools/distroless&quot; target=&quot;_blank&quot;&gt;Google Distroless Docker Images&lt;/a&gt;, que es una imagen base que solo contiene las dependencias necesarias para ejecutar tu aplicaci√≥n y elimina todo el resto de elementos (como gestores de paquetes, shells, y otros comandos) y por lo tanto, reduce la superficie de ataque de nuestros contenedores. Estas imagenes son espec√≠ficas para cada lenguaje y puede que el que necesites no est√© soportado, pero si lo est√°, no encontrar√°s una imagen m√°s segura desde donde partir.&lt;/p&gt;

&lt;h3 id=&quot;5-especifica-la-versi√≥n-de-la-imagen-base&quot;&gt;5. Especifica la versi√≥n de la imagen base&lt;/h3&gt;

&lt;p&gt;Si te has fijado, para escoger la imagen de Python hemos utilizado un &lt;em&gt;tag&lt;/em&gt;. Esto tambi√©n es importante. Para que una imagen sea reproducible, deberemos elegir un &lt;em&gt;tag&lt;/em&gt; para esa imagen que sepamos que no va a cambiar en el tiempo (&lt;em&gt;tag&lt;/em&gt;s como &lt;code class=&quot;highlighter-rouge&quot;&gt;latest&lt;/code&gt; o &lt;code class=&quot;highlighter-rouge&quot;&gt;slim&lt;/code&gt; s√≠ lo hacen, ¬°ojo!).&lt;/p&gt;

&lt;p&gt;En realidad, no es posible garantizar que un &lt;em&gt;tag&lt;/em&gt; que escojamos se vaya a mantener siempre igual, independientemente de si es uno gen√©rico como &lt;code class=&quot;highlighter-rouge&quot;&gt;latest&lt;/code&gt; o uno espec√≠fico como &lt;code class=&quot;highlighter-rouge&quot;&gt;3.6.8-alpine-slim&lt;/code&gt;. La mejor pr√°ctica de todas ser√≠a escoger la versi√≥n concreta de una imagen que queramos utilizar, y utilizar su identificador. Este identificador se puede conseguir con el comando:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;docker images --format &quot;{{.Repository}}:{{.Tag}} {{.ID}}&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Por ejemplo, si quisiese el identificador de la imagen &lt;code class=&quot;highlighter-rouge&quot;&gt;busybox&lt;/code&gt; que acabo de a√±adir a mi registro local, ejecuto:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ docker images --format &quot;{{.Repository}}:{{.Tag}} {{.ID}}&quot; |grep busybox
busybox:latest 83aa35aa1c79
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ahora, podr√≠a utilizar el identificador como &lt;code class=&quot;highlighter-rouge&quot;&gt;FROM&lt;/code&gt; de mi Dockerfile:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Dockerfile&quot;&gt;FROM 83aa35aa1c79
CMD [&quot;echo&quot;, &quot;Hola!&quot;]
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&quot;6-el-potencial-de-las-multistage-builds&quot;&gt;6. El potencial de las &lt;em&gt;multistage build&lt;/em&gt;s&lt;/h3&gt;

&lt;p&gt;Cuando creamos una imagen, podemos generar im√°genes intermedias que utilizamos para un prop√≥sito en concreto (como generar un artefacto) y que se acaban eliminando y no forman parte de la imagen final (aunque el artefacto que hemos generado s√≠). Esto se llama &lt;em&gt;multistage build&lt;/em&gt;, y es muy √∫til en casos donde haya que compilar una aplicaci√≥n, por ejemplo.&lt;/p&gt;

&lt;p&gt;Utilizar &lt;em&gt;multistage builds&lt;/em&gt; har√° que nuestra imagen final sea menos pesada, y probablemente m√°s segura. F√≠jate c√≥mo en el siguiente Dockerfile compilamos la aplicaci√≥n en una imagen que no se acaba usando y generamos un JAR que ejecutamos en la imagen final, donde no tenemos ni JDK ni Maven.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Dockerfile&quot;&gt;FROM maven:3.6.3-jdk-11 as builder
WORKDIR /app
COPY pom.xml .
RUN mvn -e -B dependency:go-offline
COPY src ./src
RUN mvn -e -B clean package

FROM adoptopenjdk:8u242-b08-jre-hotspot
COPY --from=builder /app/target/*.jar /app.jar
ENTRYPOINT [&quot;java&quot;, &quot;-jar&quot;, &quot;/app.jar&quot;]
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&quot;7-usuario-sin-privilegios&quot;&gt;7. Usuario sin privilegios&lt;/h3&gt;

&lt;p&gt;Se considera una buena pr√°ctica en un Dockerfile modificar el usuario final de la imagen a uno que disponga los privilegios justos para cumplir con el prop√≥sito de la imagen y nada m√°s. Esto har√° que nuestra imagen sea m√°s segura y evite que un usuario administrador en el contenedor gane acceso al &lt;em&gt;host&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;Para esto, lo mejor es agregar un nuevo usuario (y un grupo) y darle los permisos que necesite. Por ejemplo:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Dockerfile&quot;&gt;FROM ubuntu
RUN groupadd -r usergroup &amp;amp;&amp;amp; useradd -r -g user usergroup
ENTRYPOINT [&quot;sh&quot;, &quot;myScript.sh&quot;]
COPY ./myScript.sh /myScript.sh
RUN chown user /myScript.sh
USER user
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&quot;8-mant√©n-tus-secretos-ocultos&quot;&gt;8. Mant√©n tus secretos ocultos&lt;/h3&gt;

&lt;p&gt;Es muy habitual que en una imagen necesitemos utilizar credenciales, &lt;em&gt;token&lt;/em&gt;s de acceso o ficheros con informaci√≥n que no queremos compartir. Si pasamos estos elementos a la imagen mediante comandos como &lt;code class=&quot;highlighter-rouge&quot;&gt;COPY&lt;/code&gt; o &lt;code class=&quot;highlighter-rouge&quot;&gt;ADD&lt;/code&gt;, estar√°n visibles en la imagen y cualquiera que tenga acceso a ella podr√° verlos.&lt;/p&gt;

&lt;p&gt;Existe una forma de a√±adir esta informaci√≥n a nuestros contenedores, llamada &lt;code class=&quot;highlighter-rouge&quot;&gt;docker secret&lt;/code&gt;. La forma de implementarla es un poco compleja como para explicarla en este documento, ya que depende de la manera en la que vayas a desplegar la imagen (&lt;code class=&quot;highlighter-rouge&quot;&gt;docker-compose&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;kubernetes&lt;/code&gt;, ‚Ä¶). &lt;a href=&quot;https://dzone.com/articles/introduction-to-docker-secrets&quot; target=&quot;_blank&quot;&gt;Introduction to Docker Secrets&lt;/a&gt; o &lt;a href=&quot;https://kubernetes.io/docs/tasks/inject-data-application/distribute-credentials-secure/&quot; target=&quot;_blank&quot;&gt;Distribute Credentials Securely Using Secrets&lt;/a&gt; pueden ser un buen punto de partida.&lt;/p&gt;

&lt;h3 id=&quot;9-copia-solo-lo-que-necesites&quot;&gt;9. Copia solo lo que necesites&lt;/h3&gt;

&lt;p&gt;La imagen que generemos deber√≠a contener √∫nica y exclusivamente los ficheros que necesite. Es com√∫n ver comandos del estilo de &lt;code class=&quot;highlighter-rouge&quot;&gt;COPY . /app&lt;/code&gt;, que copiar√° todo el contexto al directorio &lt;code class=&quot;highlighter-rouge&quot;&gt;/app&lt;/code&gt;. Y esto puede no estar mal, depende del contexto y de lo que pretendamos hacer, pero en muchos casos podemos estar copiando archivos que no vamos a utilizar o que tienen informaci√≥n confidencial.&lt;/p&gt;

&lt;p&gt;Hay dos formas de evitar esto:&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;Copiar √∫nicamente los ficheros que vayamos a utilizar, aunque si son muchos y no los tenemos estructurados en directorios, puede crear demasiadas &lt;em&gt;layer&lt;/em&gt;s.&lt;/li&gt;
  &lt;li&gt;Usar &lt;code class=&quot;highlighter-rouge&quot;&gt;.dockerignore&lt;/code&gt;. En este fichero con la misma sintaxis que &lt;code class=&quot;highlighter-rouge&quot;&gt;.gitignore&lt;/code&gt; podremos decidir qu√© ficheros o directorios queremos evitar a√±adir al contexto. &lt;a href=&quot;https://docs.docker.com/engine/reference/builder/#dockerignore-file&quot; target=&quot;_blank&quot;&gt;M√°s informaci√≥n&lt;/a&gt;.&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;10-copia-no-a√±adas&quot;&gt;10. Copia, no a√±adas&lt;/h3&gt;

&lt;p&gt;Existen dos comandos en Dockerfile muy similares: &lt;code class=&quot;highlighter-rouge&quot;&gt;COPY&lt;/code&gt; y &lt;code class=&quot;highlighter-rouge&quot;&gt;ADD&lt;/code&gt;. El primero sirve para copiar una serie de ficheros o directorios desde el &lt;em&gt;host&lt;/em&gt; a la imagen. El segundo hace lo mismo, pero adem√°s es capaz de descargar elementos desde URLs o repositorios y descomprime ficheros comprimidos. Para mas informaci√≥n sobre &lt;code class=&quot;highlighter-rouge&quot;&gt;ADD&lt;/code&gt;, ver &lt;a href=&quot;https://docs.docker.com/engine/reference/builder/#add&quot; target=&quot;_blank&quot;&gt;la documentaci√≥n&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Puede que viendo que hacen lo mismo y &lt;code class=&quot;highlighter-rouge&quot;&gt;ADD&lt;/code&gt; sea m√°s potente, solo quieras usar este, pero deber√≠as evitarlo. Utiliza &lt;code class=&quot;highlighter-rouge&quot;&gt;COPY&lt;/code&gt; para la mayor√≠a de situaciones, que ser√° copiar desde el &lt;em&gt;host&lt;/em&gt;, y √∫nicamente utiliza &lt;code class=&quot;highlighter-rouge&quot;&gt;ADD&lt;/code&gt; cuando necesites algo que no puedas conseguir con &lt;code class=&quot;highlighter-rouge&quot;&gt;COPY&lt;/code&gt;. Utilizar &lt;code class=&quot;highlighter-rouge&quot;&gt;ADD&lt;/code&gt; sin tener en cuenta la diferencia puede conllevar riesgos de seguridad como &lt;a href=&quot;https://en.wikipedia.org/wiki/Zip_bomb&quot; target=&quot;_blank&quot;&gt;&lt;em&gt;zip bomb&lt;/em&gt;s&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&quot;conclusi√≥n&quot;&gt;Conclusi√≥n&lt;/h2&gt;

&lt;p&gt;Aunque escribir un Dockerfile pueda parecer algo sencillo, es importante seguir ciertas recomendaciones que har√°n que nuestro proceso de &lt;em&gt;building&lt;/em&gt; se ejecute m√°s r√°pido, y que la imagen resultante sea m√°s peque√±a y segura.&lt;/p&gt;

&lt;p&gt;En este art√≠culo hemos repasado algunos de los puntos m√°s importantes, que a la vez son muy sencillos de seguir en la mayor√≠a de los casos. Puedes encontrar m√°s consejos de este tipo en la &lt;a href=&quot;https://docs.docker.com/develop/develop-images/dockerfile_best-practices/&quot; target=&quot;_blank&quot;&gt;documentaci√≥n oficial&lt;/a&gt;.&lt;/p&gt;</content><author><name>urko</name></author><category term="docker," /><category term="dockerfile" /><summary type="html">A la hora de escribir un Dockerfile, las posibilidades son infinitas. Se pueden crear im√°genes con el mismo prop√≥sito, que funcionen similar, pero que est√©n estructuradas de una manera muy diferente. Empezando por elegir una imagen de partida (FROM), pasando por el orden de los comandos que ejecutamos al construir la imagen, o creando im√°genes intermedias (multistage builds), escribir un Dockerfile es un mundo.</summary></entry><entry xml:lang="es"><title type="html">AWS: Cuentas y Organizaciones</title><link href="https://blog.arima.eu/es/2020/04/03/aws-cuentas-y-organizaciones.html" rel="alternate" type="text/html" title="AWS: Cuentas y Organizaciones" /><published>2020-04-03T09:00:00+00:00</published><updated>2020-04-03T09:00:00+00:00</updated><id>https://blog.arima.eu/2020/04/03/aws-cuentas-y-organizaciones</id><content type="html" xml:base="https://blog.arima.eu/2020/04/03/aws-cuentas-y-organizaciones.html">&lt;p&gt;En esta entrada quiero hablar sobre las cuentas de &lt;a href=&quot;https://aws.amazon.com/&quot;&gt;Amazon Web Services&lt;/a&gt; y sobre la arquitectura que hay por detr√°s. La gesti√≥n de cuentas de AWS es un poco compleja y puede ralentizar el tiempo necesario para empezar a usar sus servicios (cada vez que pruebo algo nuevo tengo la intenci√≥n de ir directo al grano, como en este caso crear un cluster de &lt;a href=&quot;https://aws.amazon.com/eks/&quot;&gt;EKS&lt;/a&gt;, y siempre me acabo dando de frente con la cruda realidad). Espero que al final de esta entrada se√°is capaces de entender un poco mejor todos los conceptos que voy a explicaros y que agilice vuestro proceso de introducci√≥n en AWS.&lt;/p&gt;

&lt;p&gt;Bien, lo primero de lo que hay que hablar es sobre las cuentas. ¬øQu√© es una cuenta de AWS? Pues no es m√°s que eso, una cuenta, con su identificador √∫nico y su email, pero en este caso engloba ciertos conceptos propios de AWS. Cuando creas una cuenta, se crea por defecto un &lt;strong&gt;usuario&lt;/strong&gt; root de la cuenta. Estos son los elementos que puede contener una cuenta:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Usuario&lt;/strong&gt;: Se refiere a cada persona individual que vaya a utilizar los servicios de la cuenta (recomiendan tener uno por cada persona, y no hacer un usuario &lt;em&gt;developer&lt;/em&gt; o &lt;em&gt;admin&lt;/em&gt;).&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Grupo&lt;/strong&gt;: Un grupo es un conjunto de usuarios.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Rol&lt;/strong&gt;: Agrupaci√≥n de pol√≠ticas que se pueden asignar a usuarios, grupos o servicios.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Pol√≠tica&lt;/strong&gt;: Las pol√≠ticas son agrupaciones de permisos que otorgan o deniegan acceso a diferentes acciones sobre los servicios (como ver las instancias de EC2 de la cuenta, crear nuevas, o borrarlas).&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Servicio&lt;/strong&gt;: Un servicio es una funcionalidad de AWS a la que tenemos acceso, como la gesti√≥n de cl√∫sters de Kubernetes (EKS), repositorios de ficheros (&lt;a href=&quot;https://aws.amazon.com/s3/&quot;&gt;S3 buckets&lt;/a&gt;), ‚Ä¶ Lo que quiero que quede claro, es que estos servicios son propios de la cuenta en la que estamos, es decir, &lt;strong&gt;no se pueden compartir entre cuentas&lt;/strong&gt; (esto no es del todo cierto, se pueden otorgar permisos a otra cuenta para acceder a nuestros servicios, pero esto es rizar el rizo, y, por lo que entiendo, una mala utilizaci√≥n del sistema en la mayor√≠a de los casos).&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Esto que he explicado se puede gestionar desde el servicio &lt;a href=&quot;https://aws.amazon.com/iam/&quot;&gt;IAM&lt;/a&gt; (&lt;em&gt;Identity and Access Management&lt;/em&gt;).&lt;/p&gt;

&lt;h2 id=&quot;organizaciones&quot;&gt;Organizaciones&lt;/h2&gt;

&lt;p&gt;Todo esto probablemente sea todo lo que ten√©is que entender para trabajar con AWS a nivel individual, pero cuando trabajas en una empresa las cosas se complican un poco. Para dar mayor poder de gesti√≥n, AWS tiene un servicio llamado &lt;em&gt;Organizations&lt;/em&gt;. Una organizaci√≥n se puede entender como un conjunto de cuentas.&lt;/p&gt;

&lt;p&gt;Cuando una cuenta crea una organizaci√≥n, esa cuenta pasa a ser la cuenta master de la organizaci√≥n y tiene acceso total. Aqu√≠ es donde se empieza a complicar un poco el asunto. Desde esta organizaci√≥n se pueden crear nuevas cuentas de la organizaci√≥n, que son pr√°cticamente equivalentes a una cuenta creada de manera ‚Äúnormal‚Äù, como la cuenta master. Hay ciertas restricciones para estas cuentas, como que no pueden crear nuevas organizaciones ni salir de la organizaci√≥n actual (aunque he escuchado que en un futuro pr√≥ximo puede que s√≠), pero si se les otorgan los permisos necesarios, pueden llegar a tener tanto poder como la cuenta master. Por √∫ltimo, se puede invitar a nuestra organizaci√≥n a cuentas que no lo sean ya, y estas cuentas s√≠ que pueden ir y venir sin restricci√≥n.&lt;/p&gt;

&lt;p&gt;Otro concepto que introducen las organizaciones son los OU (&lt;em&gt;Organizational Unit&lt;/em&gt;). Estos elementos son agrupaciones l√≥gicas de cuentas y de OUs (un OU puede agrupar a cuentas y OUs, hasta 5 niveles de profundidad). Las diferentes cuentas de nuestra organizaci√≥n se pueden mover entre OUs sin problemas, pero hay que recordar que cada cuenta sigue teniendo sus usuarios, grupos, servicios, etc, y que estos &lt;strong&gt;no se pueden sacar de la cuenta&lt;/strong&gt;. ¬øQue por qu√© digo esto? Pues porque quiero introducir el √∫ltimo concepto importante sobre las organizaciones. Los &lt;a href=&quot;https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scp.html&quot;&gt;&lt;em&gt;Service Control Policies&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Los &lt;em&gt;Service Control Policies&lt;/em&gt; o SCPs son pol√≠ticas que se utilizan para gestionar nuestra organizaci√≥n. Son diferentes de las pol√≠ticas de una cuenta pero asumamos de momento que son iguales. Estas pol√≠ticas se pueden aplicar a la organizaci√≥n, a un OU, o a una cuenta (o a conjuntos de estos elementos), y cuando se aplica a uno de estos elementos &lt;strong&gt;tambi√©n se aplican a todos los elementos que contengan&lt;/strong&gt;. Es decir, si aplicamos un SCP a un OU &lt;em&gt;ou1&lt;/em&gt;, y &lt;em&gt;ou1&lt;/em&gt; contiene un cuenta &lt;em&gt;c1&lt;/em&gt;, el SCP se aplicar√° tanto a &lt;em&gt;ou1&lt;/em&gt; como a &lt;em&gt;c1&lt;/em&gt;. Si despu√©s movemos esta cuenta &lt;em&gt;c1&lt;/em&gt; a otro OU &lt;em&gt;ou2&lt;/em&gt;, &lt;em&gt;ou1&lt;/em&gt; seguir√° con el SCP aplicado, pero &lt;em&gt;c1&lt;/em&gt; ya no. Es decir, si movemos cuentas a nivel jer√°rquico, tenemos que tener cuidado con los SCPs que haya aplicados tanto en el origen como en el destino.&lt;/p&gt;

&lt;p&gt;Hay varias estrategias para estructurar nuestra organizaci√≥n, aqu√≠ os dejo algunas que he visto:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Por entorno de trabajo (&lt;em&gt;development, testing, production&lt;/em&gt;).&lt;/li&gt;
  &lt;li&gt;Por cliente o departamento (Y dentro de cada una de ellos podr√≠amos volver a organizarlo por entorno de trabajo, por ejemplo).&lt;/li&gt;
  &lt;li&gt;Por cada entidad a la que tengamos que cobrar (se puede ver el uso de recursos de cada OU).&lt;/li&gt;
&lt;/ul&gt;

&lt;p align=&quot;center&quot;&gt;
    &lt;img src=&quot;/assets/images/2020-04-03-aws-cuentas-y-organizaciones/OrganizationHierarchy.png&quot; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://es.slideshare.net/AmazonWebServices/wrangling-multiple-aws-accounts-with-aws-organizations-79796025&quot; target=&quot;_blank&quot; style=&quot;text-align: center; display: block;&quot;&gt;Fuente de la imagen&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;scps-vs-pol√≠ticas-de-iam&quot;&gt;SCPs vs Pol√≠ticas de IAM&lt;/h2&gt;

&lt;p&gt;De momento, hemos hablado los SCPs de las organizaciones y de las pol√≠ticas del IAM como si fuesen lo mismo, pero no lo son. Siguen siendo conjuntos de permisos, de hecho, muchos de los permisos que se utilizan son los mismos en ambos casos, pero &lt;strong&gt;la diferencia est√° en el prop√≥sito&lt;/strong&gt; que tienen.&lt;/p&gt;

&lt;p&gt;Mientras que una pol√≠tica de IAM sirve para otorgar permisos (a un usuario, grupo, servicio, ‚Ä¶) para acceder y utilizar un servicio, un SCP pretende otorgarle a una cuenta la habilidad de dar esos permisos. Es decir, para que dentro de una cuenta se use cierto permiso en concreto, un SCP deber√° haber habilitado a esa cuenta ese permiso (o no hab√©rselo denegado, seg√∫n se utilicen estrategias de &lt;em&gt;whitelist&lt;/em&gt; o &lt;em&gt;blacklist&lt;/em&gt;).&lt;/p&gt;

&lt;p&gt;Esto implica que los permisos resultantes que se le aplican a un usuario, por ejemplo, son &lt;strong&gt;la intersecci√≥n entre pol√≠ticas y SCPs&lt;/strong&gt;. Un ejemplo pr√°ctico de esto ser√≠a el siguiente:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;La cuenta &lt;em&gt;c1&lt;/em&gt; tiene asignado un SCP que le permite otorgar permisos para listar cubos de S3 y para crear nuevos cubos.&lt;/li&gt;
  &lt;li&gt;Se le aplica a un usuario &lt;em&gt;u1&lt;/em&gt; de la cuenta &lt;em&gt;a1&lt;/em&gt; una pol√≠tica de IAM que le permite listar los cubos de S3 y borrarlos.&lt;/li&gt;
  &lt;li&gt;Como la cuenta &lt;em&gt;a1&lt;/em&gt; no tiene permisos para otorgar el permiso de borrar cubos de S3, a &lt;em&gt;u1&lt;/em&gt; solo se le aplica el permiso de listar cubos.&lt;/li&gt;
&lt;/ol&gt;

&lt;p align=&quot;center&quot;&gt;
    &lt;img src=&quot;/assets/images/2020-04-03-aws-cuentas-y-organizaciones/SCPvsIAM.png&quot; /&gt;
&lt;/p&gt;

&lt;h2 id=&quot;conclusi√≥n&quot;&gt;Conclusi√≥n&lt;/h2&gt;

&lt;p&gt;Como habr√©is podido ver, el servicio para gestionar una organizaci√≥n en AWS es una herramienta potente para poder agrupar cuentas y administrarlas desde una sola, pero tiene cierta complejidad.&lt;/p&gt;

&lt;p&gt;Despu√©s de todo lo que he dicho, la recomendaci√≥n que yo os hago es: Piensa antes de actuar:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;¬øQue eres un √∫nico usuario y quieres utilizar ciertos servicios de manera individual?, pues olvidate de &lt;em&gt;Organizations&lt;/em&gt; y empieza a trabajar directamente.&lt;/li&gt;
  &lt;li&gt;¬øQue tienes que gestionar una peque√±a empresa con diferentes proyectos, departamentos o clientes?, p√°rate a plantearte tu escenario y gestiona las diversas cuentas que necesites con la jerarqu√≠a adecuada.&lt;/li&gt;
  &lt;li&gt;¬øQue eres una gran organizaci√≥n y tienes que administrar una compleja estructura de cuentas con miles de usuarios?, probablemente deber√≠as contactar con Amazon y pedir la ayuda de uno de sus arquitectos.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;El objetivo de &lt;em&gt;Organizations&lt;/em&gt; es ayudarte y deber√≠a acabar evit√°ndote m√°s problemas de los que te ha causado en un primer momento.&lt;/p&gt;</content><author><name>urko</name></author><category term="aws," /><category term="organizacion," /><category term="organizaciones," /><category term="iam," /><category term="scp," /><category term="cuenta," /><category term="cuentas" /><summary type="html">En esta entrada quiero hablar sobre las cuentas de Amazon Web Services y sobre la arquitectura que hay por detr√°s. La gesti√≥n de cuentas de AWS es un poco compleja y puede ralentizar el tiempo necesario para empezar a usar sus servicios (cada vez que pruebo algo nuevo tengo la intenci√≥n de ir directo al grano, como en este caso crear un cluster de EKS, y siempre me acabo dando de frente con la cruda realidad). Espero que al final de esta entrada se√°is capaces de entender un poco mejor todos los conceptos que voy a explicaros y que agilice vuestro proceso de introducci√≥n en AWS.</summary></entry><entry xml:lang="es"><title type="html">¬øEs viable ejecutar Java en contenedores Docker?</title><link href="https://blog.arima.eu/es/2020/02/11/java-en-contenedores-docker.html" rel="alternate" type="text/html" title="¬øEs viable ejecutar Java en contenedores Docker?" /><published>2020-02-11T09:00:00+00:00</published><updated>2020-02-11T09:00:00+00:00</updated><id>https://blog.arima.eu/2020/02/11/java-en-contenedores-docker</id><content type="html" xml:base="https://blog.arima.eu/2020/02/11/java-en-contenedores-docker.html">&lt;p&gt;En nuestro alrededor existen muchas empresas que llevan a√±os trabajando sobre Java utilizando un stack tecnol√≥gico tradicional (Spring, Tomcat, Weblogic, JPA, etc). Esta infraestructura ha sido bastante estable en el tiempo y ha sufrido pocos cambios.&lt;/p&gt;

&lt;p&gt;Sin embargo, reciemente han surgido nuevas infraestructuras cloud basadas en Kubernetes (&lt;a href=&quot;https://azure.microsoft.com/en-us/free/kubernetes-service/&quot; target=&quot;_blank&quot;&gt;Azure&lt;/a&gt;, &lt;a href=&quot;https://www.redhat.com/es/technologies/cloud-computing/openshift&quot; target=&quot;_blank&quot;&gt;Openshift&lt;/a&gt;, &lt;a href=&quot;https://aws.amazon.com/es/eks/&quot; target=&quot;_blank&quot;&gt;Amazon EKS&lt;/a&gt;, etc) y estas empresas ahora se encuentran en proceso de evaluaci√≥n o transici√≥n a Kubernetes. En este proceso, surgen dudas y se cuestiona por ejemplo, si el stack tecnol√≥gico empleado hasta ahora sigue siendo valido en estos nuevos entornos  cloud.&lt;/p&gt;

&lt;p&gt;En estos casos, como suele ser habitual, solemos echar mano de Google para consultar c√≥mo es la transici√≥n de los proyectos Java a Kubernetes. Sorprendentemente nos encontramos art√≠culos y presentaciones que nos pueden asustar a dar el salto a Kubernetes. Por ejemplo, &lt;a href=&quot;https://jaxenter.com/nobody-puts-java-container-139373.html&quot; target=&quot;_blank&quot;&gt;Nobody puts Java in a container&lt;/a&gt; o &lt;a href=&quot;https://vimeo.com/181900266&quot; target=&quot;_blank&quot;&gt;Nobody puts Java in the container&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/2020-02-11-java-en-contenedores-docker/no-body-puts-java-in-a-container.png&quot; alt=&quot;Nobody puts java in containers&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Visto esto, a todos nos viene la misma pregunta a la cabeza: ¬øes viable ejecutar Java en contenedores Docker?&lt;/p&gt;

&lt;h2 id=&quot;java-ergonomics&quot;&gt;Java Ergonomics&lt;/h2&gt;

&lt;p&gt;La plataforma Java se cre√≥ en el a√±o 1995 y un poco m√°s tarde vinieron los servidores web y servidores de aplicaci√≥n para desarrollar aplicaciones Web sobre Java. En aquel entonces no exist√≠a el concepto de &lt;a href=&quot;https://www.docker.com/resources/what-container&quot; target=&quot;_blank&quot;&gt;contenedor&lt;/a&gt; ni tampoco el movimiento &lt;a href=&quot;https://www.cncf.io/&quot; target=&quot;_blank&quot;&gt;cloud native&lt;/a&gt;. Lo habitual era que el servidor de aplicaciones Java se ejecutara en una m√°quina dedicada y en dicho servidor se desplegaban m√∫ltiples aplicaciones Web (wars o ears).&lt;/p&gt;

&lt;p align=&quot;center&quot;&gt;
    &lt;img src=&quot;/assets/images/2020-02-11-java-en-contenedores-docker/servidor-java-ee.png&quot; /&gt;
&lt;/p&gt;

&lt;p&gt;Java fue dise√±ado para ejecutarse sobre este tipo de infraestructuras, una √∫nica JVM en un servidor. En base a esto, la JVM ejecuta el proceso &lt;a href=&quot;https://docs.oracle.com/javase/8/docs/technotes/guides/vm/gctuning/ergonomics.html&quot; target=&quot;_blank&quot;&gt;Java Ergonomics&lt;/a&gt; que calcula los par√°metros de configuraci√≥n de JVM en funci√≥n de los recursos HW disponibles en la m√°quina. Por ejemplo, Java Ergonomics establece el tama√±o de heap m√°ximo de JVM como la cuarta parte de la RAM del servidor. Es decir, en un servidor con 64GB de RAM el tama√±o m√°ximo del Heap es 16GB por defecto.&lt;/p&gt;

&lt;p&gt;Todo bien hasta ahora. Un servidor para cada JVM y Java Ergonomics configura la JVM en base a los recursos del servidor. Pero, ¬øqu√© ocurre si ejecutamos Java Ergonomics en un contenedor Docker?&lt;/p&gt;

&lt;h2 id=&quot;primeras-experiencias-de-java-en-docker&quot;&gt;Primeras experiencias de Java en Docker&lt;/h2&gt;

&lt;p&gt;Cuando ejecutamos una aplicaci√≥n Java en un contenedor, nos interesa que Java Ergonomics calcule los par√°metros de JVM en funci√≥n de los recursos del propio contenedor. Por ejemplo, si arrancamos un contenedor con 4GB de memoria, esperamos que Java Ergonomics establezca 1GB de heap m√°ximo.&lt;/p&gt;

&lt;p&gt;Sin embargo, las primeras experiencias de Java en contenedores demostraron que eso no era as√≠. Java Ergonomics continuaba configurando la JVM en base a los recursos del servidor en lugar de los recursos del contenedor. Es decir, si el servidor tiene 64GB de RAM, se establec√≠a 16 GB de heap m√°ximo, en lugar de 1GB que se esperaba. Esto hac√≠a que al escalar una aplicaci√≥n, por ejemplo a 5 contenedores, se agotara toda la memoria del servidor porque la suma del heap de todos los containers superaba la memoria del servidor (16GB * 5 &amp;gt; 64GB).&lt;/p&gt;

&lt;p&gt;La manera de solventar esto consist√≠a en utilizar los flags de configuraci√≥n de Java Ergonomics (-Xmx, -Xms, etc), pero algunos se dieron cuenta demasiado tarde, cuando la aplicaci√≥n que ten√≠an en producci√≥n estaba sufriendo ca√≠das y problemas de memoria OOMKilled. Este tipo de problemas motivaron los art√≠culos antes citados que advert√≠an del riesgo que implicaba ejecutar Java en contenedores.&lt;/p&gt;

&lt;h2 id=&quot;java-container-aware&quot;&gt;Java Container Aware&lt;/h2&gt;

&lt;p&gt;Conocidos los problemas de Java Ergonomics con los contenedores Docker, &lt;a href=&quot;https://blogs.oracle.com/java-platform-group/java-se-support-for-docker-cpu-and-memory-limits&quot; target=&quot;_blank&quot;&gt;Oracle reaccion√≥&lt;/a&gt; e implement√≥ un soporte de contenedores experimental en las versiones Java 8u131 y Java 9. Sin embargo, este soporte experimental ten√≠a carencias que finalmente fueron resueltas en las versiones Java 8u191 y Java 10.&lt;/p&gt;

&lt;p&gt;A partir de estas versiones, Java Ergonomics calcula autom√°ticamente la configuraci√≥n de JVM en base a los recursos del contenedor. Si quer√©is probar las diferencias entre versiones diferentes de Java en contenedores, pod√©is jugar con este &lt;a href=&quot;https://github.com/wearearima/docker-java-cpu-memory-limit&quot; target=&quot;_blank&quot;&gt;repositorio&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Asimismo, tambi√©n se a√±adieron nuevas opciones de configuraci√≥n en la JVM para ajustar mejor la configuraci√≥n del heap en un contenedor: &lt;code class=&quot;highlighter-rouge&quot;&gt;InitialRAMPercentage&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;MaxRAMPercentage&lt;/code&gt; y &lt;code class=&quot;highlighter-rouge&quot;&gt;MinRAMPercentage&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Con todos estos cambios, ya se considera que &lt;strong&gt;Java es Container Aware a partir de las versiones Java 8u191 y Java 10&lt;/strong&gt;.&lt;/p&gt;

&lt;h2 id=&quot;conclusiones&quot;&gt;Conclusiones&lt;/h2&gt;

&lt;p&gt;Cuando se cre√≥ Java en 1995 nadie se imaginaba que surgir√≠an las tecnolog√≠as Docker, Kubernetes, etc. Entonces, ¬øes viable ejecutar Java en contenedores?&lt;/p&gt;

&lt;p&gt;La respuesta es que s√≠. La comunidad Java est√° reaccionando y se est√° adaptando a los cambios que suponen estas nuevas tecnolog√≠as cloud y contenedores. Uno de los primeros obst√°culos fue solventar la compatibilidad entre Java Ergonomics y los contendores. Ese escollo ya est√° resuelto con las versiones superiores de Java y no nos tendremos que volver a preocupar.&lt;/p&gt;

&lt;p&gt;De todos modos, hay otros aspectos de la plataforma Java como puede ser el peso de la m√°quina virtual que la comunidad est√° tratando de mejorar. En este sentido, tambi√©n hay mucho movimiento y est√°n surgiendo nuevas herramientas y frameworks que hay que vigilar (&lt;a href=&quot;https://www.graalvm.org/docs/reference-manual/native-image/&quot; target=&quot;_blank&quot;&gt;Graal Native Image&lt;/a&gt;, &lt;a href=&quot;https://micronaut.io/&quot; target=&quot;_blank&quot;&gt;Micronaut&lt;/a&gt;, &lt;a href=&quot;https://quarkus.io/&quot; target=&quot;_blank&quot;&gt;Quarkus&lt;/a&gt;, etc).&lt;/p&gt;</content><author><name>telle</name></author><category term="docker," /><category term="containers," /><category term="java," /><category term="contenedores" /><summary type="html">En nuestro alrededor existen muchas empresas que llevan a√±os trabajando sobre Java utilizando un stack tecnol√≥gico tradicional (Spring, Tomcat, Weblogic, JPA, etc). Esta infraestructura ha sido bastante estable en el tiempo y ha sufrido pocos cambios.</summary></entry><entry xml:lang="es"><title type="html">Utilizando el est√°ndar OAuth2 de forma segura</title><link href="https://blog.arima.eu/es/2020/01/27/oauth2.html" rel="alternate" type="text/html" title="Utilizando el est√°ndar OAuth2 de forma segura" /><published>2020-01-27T09:00:00+00:00</published><updated>2020-01-27T09:00:00+00:00</updated><id>https://blog.arima.eu/2020/01/27/oauth2</id><content type="html" xml:base="https://blog.arima.eu/2020/01/27/oauth2.html">&lt;p&gt;El est√°ndar OAuth2 es tan conocido como complejo. El hecho de que sea un est√°ndar en evoluci√≥n y el exceso de informaci√≥n disponible, hace que sea muy f√°cil encontrar art√≠culos con informaci√≥n contradictoria o que se recomiende el uso de flujos que actualmente se consideran ‚Äúlegacy‚Äù por motivos de seguridad.&lt;/p&gt;

&lt;p&gt;En este art√≠culo, haremos un repaso de los flujos que componen OAuth2 y recomendaremos los flujos a utilizar para cubrir distintos escenarios. Pero antes, empecemos desde el principio.&lt;/p&gt;

&lt;h2 id=&quot;qu√©-demonios-es-oauth-y-por-qu√©-deber√≠a-importarme&quot;&gt;¬øQu√© demonios es OAuth y por qu√© deber√≠a importarme?&lt;/h2&gt;
&lt;p&gt;Como estas cosas se entienden mejor con un ejemplo, vamos a ponernos en situaci√≥n y pensar que queremos desarrollar una aplicaci√≥n web que gestiona fotos. Como sabemos que muchos de nuestros usuarios potenciales utilizan Google Photos para almacenar y gestionar sus √°lbumes de fotos, vemos interesante que nuestra aplicaci√≥n pueda conectarse con Google para obtener los √°lbumes del usuario que est√° utilizando nuestra aplicaci√≥n. Investigamos un poco y vemos que Google &lt;a href=&quot;https://developers.google.com/photos/library/reference/rest/v1/albums/list&quot; target=&quot;_blank&quot;&gt;ofrece una API para obtener el listado de √°lbumes de un usuario&lt;/a&gt; as√≠ que todo parece encajar a la perfecci√≥n.&lt;/p&gt;

&lt;p&gt;Evidentemente, el servicio de Google Photos no es p√∫blico y requiere que el usuario final est√© autenticado de alguna forma.&lt;/p&gt;

&lt;h3 id=&quot;c√≥mo-podemos-conseguir-esto&quot;&gt;¬øC√≥mo podemos conseguir esto?&lt;/h3&gt;
&lt;p&gt;Una opci√≥n podr√≠a ser que ese usuario introdujera sus credenciales de Google (usuario y password) en nuestra aplicaci√≥n, de forma que nuestra aplicaci√≥n pudiera autenticarse contra Google en nombre de ese usuario y de esta manera, obtener sus √°lbumes. Esto no tendr√≠a mucho sentido ya que estar√≠amos entregando a la aplicaci√≥n la llave de nuestra cuenta de Google y adem√°s de los √°lbumes, podr√≠a acceder a todo tipo de informaci√≥n o realizar cualquier acci√≥n en nuestro nombre.&lt;/p&gt;

&lt;p&gt;Necesitamos por tanto, un sistema que permita otorgar acceso a cierta informaci√≥n por parte de aplicaciones de terceros pero indicando expl√≠citamente qu√© acciones se van a poder realizar en nuestro nombre y sin tener que entregar para ello nuestras crendenciales. El est√°ndar OAuth nace precisamente para dar respuesta a esta necesidad. El primer borrador de OAuth fu√© publicado en 2007 y fu√© desarrollado principalmente por gente de Twitter y Google. En abril de 2010 se public√≥ la &lt;a href=&quot;https://tools.ietf.org/html/rfc5849&quot; target=&quot;_blank&quot;&gt;versi√≥n 1.0 del protocolo OAuth.&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Retomando el ejemplo anterior, si implement√°semos la aplicaci√≥n de gesti√≥n de fotos utilizando OAuth, ver√≠amos que cuando nuestra aplicaci√≥n necesitase acceder a la API que devuelve el listado de √°lbumes que el usario en curso tiene en Google Photos, en lugar de pedir que el usuario introduzca las credenciales de Google en nuestra aplicaci√≥n, se redirigir√≠a a una pantalla de login gestionada por Google.&lt;/p&gt;

&lt;p&gt;Una vez completada la autenticaci√≥n, se le mostrar√≠a una pantalla en la que tendr√≠a que dar el cosentimiento expl√≠cito para que la aplicaci√≥n pudiera consumir esa (y solo esa) informaci√≥n:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/2020-01-27-oauth2/oauth2-consent.png&quot; alt=&quot;Ejemplo de pantalla de consentimiento&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Tras el consentimiento del usuario, Google se encarga de devolver el control a la aplicaci√≥n que inici√≥ el proceso proporcion√°ndole un token con una fecha de caducidad. La aplicaci√≥n podr√° utilizar este token en las llamadas a las APIs que correspondan para acceder a la informaci√≥n para la que ha sido autorizado.&lt;/p&gt;

&lt;p&gt;El problema de la primera versi√≥n de OAuth es que era complejo, estaba dirigido sobre todo a aplicaciones web y no era demasiado escalable. Para dar respuesta a estas limitaciones, en 2012 se public√≥ &lt;a href=&quot;https://tools.ietf.org/html/rfc6749&quot; target=&quot;_blank&quot;&gt;la versi√≥n 2.0&lt;/a&gt; del protocolo OAuth junto con el est√°ndar para el uso de &lt;a href=&quot;https://tools.ietf.org/html/rfc6750&quot; target=&quot;_blank&quot;&gt;‚Äúbearer tokens‚Äù&lt;/a&gt;. Se puede decir que OAuth2 es una reescritura del est√°ndar ya que se aplicaron todas las lecciones aprendidas con la primera versi√≥n y esto a su vez les oblig√≥ a romper compatibilidad con la primera versi√≥n.&lt;/p&gt;

&lt;p&gt;En el est√°ndar OAuth2 se hace referencia a los siguientes roles que son los que participan en los distintos flujos disponibles:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Resource Owner:&lt;/strong&gt; Es el due√±o de la informaci√≥n a la que se intenta acceder. En el ejemplo anterior, ser√≠a el usuario que est√° utilizando la aplicaci√≥n y que es el due√±o de las fotos de Google Photos a las que se intenta acceder.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Client Application:&lt;/strong&gt; Es la aplicaci√≥n que pretende acceder al recurso protegido. En el ejemplo anterior, ser√≠a la aplicaci√≥n que hemos desarrollado nosotros.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Authorization Server:&lt;/strong&gt; Es el servicio encargado de emitir tokens que permiten el acceso a un recurso protegido una vez que el due√±o de dicho recurso haya otorgado su consentimiento. En el ejemplo anterior, el Authorization Server ser√≠a el servicio central de Google que se encarga de autorizar usuarios &lt;a href=&quot;&quot; target=&quot;_blank&quot;&gt;https://accounts.google.com&lt;/a&gt;.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Resource Server:&lt;/strong&gt; Se refiere al servicio que expone los recursos protegidos a los que se pretende acceder. En nuestro ejemplo, este papel corresponder√≠a al servicio Google Photos de Google.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Tal y como hemos apuntado, el objetivo de OAuth es impedir que el usuario tenga que introducir sus credenciales en aplicaciones de terceros para darles acceso a los recursos que pueda disponer en otras aplicaciones. Para conseguir esto, se realiza un proceso de autorizaci√≥n en el que intervienen los distintos actores implicados (‚ÄúResource Owner‚Äù, ‚ÄúClient Application‚Äù y ‚ÄúAuthorization Server‚Äù) cuyo resultado es un token con el que la aplicaci√≥n puede invocar las APIs que dan acceso a los recursos protegidos. Existen distintas variaciones de este flujo para adecuarse a diferentes escenarios:&lt;/p&gt;

&lt;h2 id=&quot;authorization-code-grant&quot;&gt;Authorization code grant&lt;/h2&gt;

&lt;p&gt;Se podr√≠a decir que este es el flujo OAuth2 principal y el que se deber√≠a utilizar en todos los casos en los que sea posible. Este flujo se puede utilizar cuando tenemos una aplicaci√≥n en la que la l√≥gica de presentaci√≥n se lleva principalmente en el servidor, es decir, el servidor es el encargado de renderizar los HTML. A continuaci√≥n se especifican los pasos que se llevan a cabo en este flujo:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/images/2020-01-27-oauth2/authorization-code-grant.png&quot; target=&quot;_blank&quot;&gt;&lt;img src=&quot;/assets/images/2020-01-27-oauth2/authorization-code-grant.png&quot; alt=&quot;Authorization code grant&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;0. Hay un proceso previo en el que se registra la aplicaci√≥n cliente en el ‚ÄúAuthorization Server‚Äù. Para llevar a cabo este registro, hay que indicar el &lt;code class=&quot;highlighter-rouge&quot;&gt;client-id&lt;/code&gt;, el &lt;code class=&quot;highlighter-rouge&quot;&gt;client-secret&lt;/code&gt; y &lt;code class=&quot;highlighter-rouge&quot;&gt;redirect-uri&lt;/code&gt; de la aplicaci√≥n que se est√° registrando. Normalmente los ‚ÄúAuthorizations Servers‚Äù permiten registrar varias URIs de redirecci√≥n. En el caso de Google, este registro se lleva a cabo en el portal de desarrolladores (m√°s info &lt;a href=&quot;https://developers.google.com/identity/protocols/OAuth2WebServer#enable-apis&quot; target=&quot;_blank&quot;&gt;aqu√≠&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;1. y 2. Cuando el usuario intenta acceder a una parte de la aplicaci√≥n que necesita poder acceder a su cuenta de Google Photos, se iniciar√° el flujo OAuth2. El objetivo de este flujo es que el usuario pueda dar su consentimiento a que la aplicaci√≥n acceda a informaci√≥n de Google Photos en su nombre. Para ello, forzar√° una redirecci√≥n del navegador a la URL de autenticaci√≥n que expone el ‚ÄúAuthorization Server‚Äù pas√°ndole los siguientes par√°metros en la URL como ‚Äúquery string‚Äù:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;em&gt;response_type:&lt;/em&gt; El valor de este par√°metro indica el tipo de flujo que queremos iniciar. En este caso ser√° &lt;code class=&quot;highlighter-rouge&quot;&gt;code&lt;/code&gt; ya que es el valor correspondiente al ‚ÄúAuthorization Code Grant‚Äù.&lt;/li&gt;
  &lt;li&gt;&lt;em&gt;client_id:&lt;/em&gt; El identificador del cliente que est√° iniciando el flujo.&lt;/li&gt;
  &lt;li&gt;&lt;em&gt;scope:&lt;/em&gt; En esta propiedad se indica a qu√© recursos del usuario pretende acceder la aplicaci√≥n pudiendo establecerse m√°s de un scope. En el ejemplo se ha utilizado &lt;code class=&quot;highlighter-rouge&quot;&gt;https://www.googleapis.com/auth/photoslibrary&lt;/code&gt; que &lt;a href=&quot;https://developers.google.com/photos/library/reference/rest/v1/albums/list#authorization-scopes&quot; target=&quot;_blank&quot;&gt;seg√∫n la documentaci√≥n&lt;/a&gt; es uno de los scopes que permiten acceder a los √°lbumes de un usuario.&lt;/li&gt;
  &lt;li&gt;&lt;em&gt;redirect_uri:&lt;/em&gt; La URI a la que el ‚ÄúAuthorization Server‚Äù tiene que redirigir una vez que el usuario haya otorgado su consentimiento. Esta URI tiene que coincidir con alguna de las URI que se ha registrado para la aplicaci√≥n.&lt;/li&gt;
  &lt;li&gt;&lt;em&gt;state:&lt;/em&gt; Se trata de un valor que la aplicaci√≥n cliente utiliza para mantener un estado entre la petici√≥n que inici√≥ el flujo y la respuesta que llega en el callback. El ‚ÄúAuthorization Server‚Äù incluye este valor en la petici√≥n que devuelve el control a la aplicaci√≥n que inici√≥ el flujo OAuth. Este par√°metro tambi√©n se puede utilizar como mecanismo de defensa ante ataques CSRF (‚ÄúCross Site Request Forguery‚Äù) tal y como se indica en &lt;a href=&quot;https://tools.ietf.org/html/rfc6749#section-10.12&quot; target=&quot;_blank&quot;&gt;el RFC6749&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;3. ,4. y 5. El usuario llega a la pantalla de login del ‚ÄúAuthorization Server‚Äù (Google Accounts en el caso de google) e introduce sus credenciales.&lt;/p&gt;

&lt;p&gt;6. y 7. Una vez validadas las credenciales, el ‚ÄúAuthorization Server‚Äù muestra una pantalla en la que se le enumeran los accesos o scopes que la aplicaci√≥n cliente est√° solicitando. En este caso, se pedir√≠a permiso para poder acceder a los √°lbumes de fotos.&lt;/p&gt;

&lt;p&gt;8. y 9. El usuario da su consentimiento para que la aplicaci√≥n cliente pueda acceder a la informaci√≥n solicitada y esto provoca una redirecci√≥n a la url &lt;code class=&quot;highlighter-rouge&quot;&gt;redirect_uri&lt;/code&gt; que se hab√≠a enviado al iniciar el flujo. En esta URL, se a√±adir√° como par√°metro un &lt;code class=&quot;highlighter-rouge&quot;&gt;code&lt;/code&gt; y el &lt;code class=&quot;highlighter-rouge&quot;&gt;state&lt;/code&gt; cuyo valor tendr√° que ser el mismo que la aplicaci√≥n cliente envi√≥ al iniciar el flujo.&lt;/p&gt;

&lt;p&gt;10. y 11. La aplicaci√≥n cliente obtiene el &lt;code class=&quot;highlighter-rouge&quot;&gt;code&lt;/code&gt; de la URL e intercambia este &lt;code class=&quot;highlighter-rouge&quot;&gt;code&lt;/code&gt; por un &lt;code class=&quot;highlighter-rouge&quot;&gt;access_token&lt;/code&gt; haciendo una petici√≥n POST al endpoint que el ‚ÄúAuthorization Server‚Äù habr√° dispuesto para tal efecto (en el caso de Google &lt;code class=&quot;highlighter-rouge&quot;&gt;https://oauth2.googleapis.com/token&lt;/code&gt;). Adem√°s del &lt;code class=&quot;highlighter-rouge&quot;&gt;code&lt;/code&gt;, tambi√©n es necesario que la aplicaci√≥n cliente env√≠e su &lt;code class=&quot;highlighter-rouge&quot;&gt;client_id&lt;/code&gt; y su &lt;code class=&quot;highlighter-rouge&quot;&gt;client_secret&lt;/code&gt; en el cuerpo de la petici√≥n.&lt;/p&gt;

&lt;p&gt;12. La aplicaci√≥n cliente puede utilizar el &lt;code class=&quot;highlighter-rouge&quot;&gt;access_token&lt;/code&gt; que ha recibido para obtener los √°lbumes que el usuario tiene alojados en Google Photos. Para conseguir esta informaci√≥n puede hacer peticiones al servicio &lt;code class=&quot;highlighter-rouge&quot;&gt;https://www.googleapis.com/auth/photoslibrary&lt;/code&gt; enviando el &lt;code class=&quot;highlighter-rouge&quot;&gt;access_token&lt;/code&gt; en la cabecera HTTP ‚ÄúAuthorization: Bearer‚Äù tal y como se indica en la &lt;a href=&quot;https://tools.ietf.org/html/rfc6750&quot; target=&quot;_blank&quot;&gt;especificaci√≥n&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;El √∫ltimo paso consistir√≠a en que el ‚ÄúResource Server‚Äù validase el &lt;code class=&quot;highlighter-rouge&quot;&gt;access_token&lt;/code&gt; antes de devolver la informaci√≥n protegida. La forma en la que se lleve a cabo esta validaci√≥n depender√° principalmente de la naturaleza del token ya que los ‚ÄúAuthorization Server‚Äù normalmente pueden enviar dos tipos de tokens:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;JWTs firmados:&lt;/strong&gt; Un JWT es un string con formato JSON que est√° firmado y codificado siguiendo los criterios especificados en la &lt;a href=&quot;https://tools.ietf.org/html/rfc7519&quot; target=&quot;_blank&quot;&gt;RFC 7519&lt;/a&gt;. El hecho de que el contenido del JWT est√© firmado, hace que se pueda verificar la validez del mismo sin tener que hacer ninguna llamada remota. Por lo tanto, si el resource server recibe un token de este tipo, puede verificarlo y devolver directamente la informaci√≥n solicitada.&lt;/p&gt;

    &lt;p&gt;Los JWTs &lt;a href=&quot;https://tools.ietf.org/html/rfc7519#section-4.1.4&quot; target=&quot;_blank&quot;&gt;tienen una propiedad (&lt;code class=&quot;highlighter-rouge&quot;&gt;exp&lt;/code&gt;)&lt;/a&gt; en la que se indica la fecha de expiraci√≥n del mismo. Por lo tanto, el resource server tendr√° que verificar tambi√©n que el JWT no est√© caducado.&lt;/p&gt;

    &lt;p&gt;Utilizar JWTs como tokens de acceso es una pr√°ctica bastante habitual. El objetivo de utilizar este tipo de tokens autocontenidos suele ser evitar el tener que hacer peticiones adicionales al ‚ÄúAuthorization Server‚Äù para verificar si el token es v√°lido. De esta forma, el token ser√° v√°lido mientras no se alcance su fecha de expiraci√≥n.&lt;/p&gt;

    &lt;p&gt;Sin embargo, ¬øqu√© ocurre en caso de que el &lt;code class=&quot;highlighter-rouge&quot;&gt;access_token&lt;/code&gt; se revoque por cualquier motivo? Desde el panel de administraci√≥n de Google por ejemplo, un usuario puede quitar en cualquier momento los permisos que ha otorgado a una aplicaci√≥n determinada. Esto provoca que todos los &lt;code class=&quot;highlighter-rouge&quot;&gt;access_token&lt;/code&gt; y &lt;code class=&quot;highlighter-rouge&quot;&gt;refresh_token&lt;/code&gt; que se hubieran expedido para esa aplicaci√≥n sean revocados de inmediato.&lt;/p&gt;

    &lt;p&gt;En este escenario, lo que ocurrir√≠a es que el ‚ÄúResource Server‚Äù no ser√≠a consciente de esta revocaci√≥n porque lo √∫nico que hace es validar que est√© correctamente firmado y que la fecha de expiraci√≥n que contiene no haya vencido. En definitiva, seguir√≠a aceptando el token revocado hasta que este caducase. Este es uno de los motivos por los que no se aconseja utilizar JWTs como &lt;code class=&quot;highlighter-rouge&quot;&gt;access_token&lt;/code&gt;.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Tokens Opacos&lt;/strong&gt;: Al contrario que los JWT, los tokens opacos no contienen ning√∫n tipo de informaci√≥n legible para el cliente y por este motivo, pueden ser una secuencia de caracter√©s pseudoaleatorios. Este hecho hace que el ‚ÄúAuthorization Server‚Äù tenga que mantener un registro de los &lt;code class=&quot;highlighter-rouge&quot;&gt;access_token&lt;/code&gt; que ha expedido y que tenga que exponer un endpoint al que el ‚ÄúResource Server‚Äù pueda hacer peticiones para verificar la validez de los token que recibe. A este proceso de validaci√≥n se le llama introspecci√≥n y est√° especificado en la &lt;a href=&quot;https://tools.ietf.org/html/rfc7662&quot; target=&quot;_blank&quot;&gt;RFC 7662.&lt;/a&gt;&lt;/p&gt;

    &lt;p&gt;La recomendaci√≥n es utilizar este tipo de tokens como &lt;code class=&quot;highlighter-rouge&quot;&gt;access_token&lt;/code&gt; y hacer verificaciones utilizando el endpoint de introspecci√≥n.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Los &lt;code class=&quot;highlighter-rouge&quot;&gt;access_token&lt;/code&gt; suelen tener una fecha de expiraci√≥n muy cercana en el tiempo (por debajo de una hora) para que si este se ve comprometido, solo pueda explotarse durante un corto periodo de tiempo. Esto que en un principio suena l√≥gico tiene un inconveniente:&lt;/p&gt;

&lt;p&gt;¬øQu√© ocurre cuando el &lt;code class=&quot;highlighter-rouge&quot;&gt;access_token&lt;/code&gt; que una aplicaci√≥n ha obtenido legitimamente caduca? ¬øHay que volver a iniciar el flujo OAuth pidiendo el consentimiento del usuario final? Esto no parece muy usable en la mayor√≠a de casos.&lt;/p&gt;

&lt;p&gt;Para dar respuesta a esta problem√°tica, en la especificaci√≥n OAuth2 se recoge la posibilidad de obtener nuevos &lt;code class=&quot;highlighter-rouge&quot;&gt;access_token&lt;/code&gt; utilizando &lt;a href=&quot;https://tools.ietf.org/html/rfc6749#section-6&quot; target=&quot;_blank&quot;&gt;un flujo de refresco&lt;/a&gt;. Para ejecutar este proceso de refresco, es necesario haber obtenido previamente un token adicional denominado &lt;code class=&quot;highlighter-rouge&quot;&gt;refresh_token&lt;/code&gt;. Este token viene junto con el &lt;code class=&quot;highlighter-rouge&quot;&gt;access_token&lt;/code&gt; en el paso 11) del diagrama anterior siempre y cuando se hayan dado las condiciones para ello. En el caso de Google por ejemplo, la condici√≥n para que devuelva un &lt;code class=&quot;highlighter-rouge&quot;&gt;refresh_token&lt;/code&gt; es que en la petici√≥n que inicia el flujo se a√±ada el par√°metro &lt;code class=&quot;highlighter-rouge&quot;&gt;access_type&lt;/code&gt; con el valor &lt;code class=&quot;highlighter-rouge&quot;&gt;offline&lt;/code&gt;. &lt;a href=&quot;https://developers.google.com/identity/protocols/OAuth2WebServer#obtainingaccesstokens&quot; target=&quot;_blank&quot;&gt;Este&lt;/a&gt; es el apartado de la documentaci√≥n en el que se hace referencia a este par√°metro:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/2020-01-27-oauth2/access_type.png&quot; alt=&quot;Google OAuth2 access_type&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Tal y como se ha comentado, el ‚ÄúAuthorization Code Grant‚Äù es el flujo recomendado para la mayor√≠a de casos pero tiene un requisito que no todas las aplicaci√≥nes pueden cumplir: necesita poder almacenar un &lt;code class=&quot;highlighter-rouge&quot;&gt;client_secret&lt;/code&gt; de forma segura ya que este valor es necesario para hacer el intercambio del &lt;code class=&quot;highlighter-rouge&quot;&gt;code&lt;/code&gt; por el &lt;code class=&quot;highlighter-rouge&quot;&gt;access_token&lt;/code&gt; en el paso 10) del proceso.&lt;/p&gt;

&lt;p&gt;Hay aplicaciones que por su naturaleza no pueden almacenar secretos sin que estos se vean f√°cilmente comprometidos. Dos ejemplos claros de este tipo de aplicaciones ser√≠an:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Las aplicaciones cuya l√≥gica de presentaci√≥n se ejecuta integramente en el navegador haciendo uso de Javascript (tambi√©n conocidas como single page applications o SPAs).&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Aplicaciones m√≥viles nativas.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Decimos que este tipo de aplicaciones no pueden almacenar secretos porque el c√≥digo es f√°cilmente accesible por el usuario final. En el caso de las aplicaciones SPA por ejemplo, es suficiente con abrir las herramientas de desarrollador e inspeccionar el c√≥digo fuente o analizar las peticiones que se hacen al servidor para obtener el secreto. Se puede aplicar pr√°cticamente lo mismo para las aplicaciones m√≥viles nativas aunque el esfuerzo necesario para poder lograr esta informaci√≥n sea un poco mayor.&lt;/p&gt;

&lt;p&gt;Es en este punto cuando los desarrolladores empezamos a dirigir nuestra atenci√≥n hacia otros flujos que tambi√©n se contemplan en la especificaci√≥n como pueden ser el ‚ÄúResource Owner Password Credentials Grant‚Äù y el ‚ÄúImplicit Grant‚Äù.&lt;/p&gt;

&lt;h2 id=&quot;resource-owner-password-credentials-grant&quot;&gt;Resource owner password credentials grant&lt;/h2&gt;

&lt;p&gt;En este flujo, se utilizan directamente las credenciales del resource owner como forma de autorizaci√≥n para obtener un token. Este ser√≠a el diagrama del flujo:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/images/2020-01-27-oauth2/resource-owner-password-credentials-grant.png&quot; target=&quot;_blank&quot;&gt;&lt;img src=&quot;/assets/images/2020-01-27-oauth2/resource-owner-password-credentials-grant.png&quot; alt=&quot;Resource owner credentials grant&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Como se puede ver en el diagrama, en este flujo el usuario introduce sus credenciales directamente en la aplicaci√≥n cliente para que haciendo uso de estas credenciales, la aplicaci√≥n pueda solicitar tokens de acceso al ‚ÄúAuthorization Server‚Äù.&lt;/p&gt;

&lt;h3 id=&quot;un-momento&quot;&gt;Un momento‚Ä¶&lt;/h3&gt;

&lt;p&gt;¬øNo hab√≠amos dicho que con OAuth precisamente se busca evitar el tener que introducir las credenciales en aplicaciones de terceros?&lt;/p&gt;

&lt;p&gt;Efectivamente y es por eso que en la especificaci√≥n se indica lo siguiente:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;The credentials should only be used when there is a high
degree of trust between the resource owner and the client (e.g., the
client is part of the device operating system or a highly privileged
application), and when other authorization grant types are not
available (such as an authorization code).&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Es decir, dicen que solo se debe utilizar este flujo en aplicaciones que son de un alto nivel de confianza y cuando no se puede utilizar ning√∫n otro flujo. A pesar de esto, en la pr√°ctica &lt;strong&gt;la recomendaci√≥n es no utilizar este flujo en ning√∫n caso&lt;/strong&gt;. Los motivos principales por los que utilizar este flujo se considera mala pr√°ctica son los siguientes:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Se fomentan malos h√°bitos de los usuarios ya que este flujo es muy parecido a un ataque de ‚Äúphishing‚Äù: se le presenta un formulario al usuario en el que se le pide que introduzca sus credenciales de otra aplicaci√≥n como puede ser Google en lugar de redirigirle a la pantalla de autenticaci√≥n de esa aplicaci√≥n.&lt;/p&gt;

    &lt;p&gt;El usuario deber√≠a acostumbrarse a √∫nicamente introducir sus credenciales en la pantalla de login de la plataforma y desconfiar si cualquier otra aplicaci√≥n le pide que las introduzca.&lt;/p&gt;

    &lt;p&gt;Google por ejemplo, utiliza una pantalla central para gestionar la autenticaci√≥n y es la misma tanto para sus propios productos (Gmail, Google Calendar, Drive,‚Ä¶) como para las integraciones con terceros.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Las credenciales de un usuario son informaci√≥n altamente sensible. Por lo tanto, es preferible que sean manejadas por el menor n√∫mero de aplicaciones posible con el objetivo de reducir las probabilidades de que pueda haber fugas de informaci√≥n tanto de manera malintencionada como por accidente (v√≠a logs, etc.).&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;En el flujo ‚ÄúResource Owner Password Credentials Grant‚Äù el usuario introduce sus credenciales pero no tiene el control sobre qu√© uso se va a hacer de los mismos. Al explicar el ‚ÄúAuthorization Code Grant‚Äù se ha visto como el ‚ÄúAuthorization Server‚Äù se encarga de mostrar una pantalla de consentimiento al usuario para autorizar que la aplicaci√≥n pueda realizar una serie de acciones (scopes) en su nombre. Por el contrario, en el ‚ÄúResource Owner Password Credentials Grant‚Äù, una vez que la aplicaci√≥n dispone de las credenciales, puede establecer los scopes que considere oportunos sin el consentimiento del usuario.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Debido a estas problem√°ticas y otras que no se han recogido en este art√≠culo, &lt;strong&gt;este flujo no est√° soportado por Google y muchos otros Authorization Servers.&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;implicit-grant&quot;&gt;Implicit grant&lt;/h2&gt;

&lt;p&gt;Este es el flujo que se ha venido recomendando para aplicaciones m√≥viles y SPAs hasta hace no demasiado tiempo. El diagrama de este flujo es el siguiente:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/images/2020-01-27-oauth2/implicit-grant.png&quot; target=&quot;_blank&quot;&gt;&lt;img src=&quot;/assets/images/2020-01-27-oauth2/implicit-grant.png&quot; alt=&quot;Implicit grant&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Este flujo es una versi√≥n simplificada del ‚ÄúAuthorization Code Grant‚Äù. En la primera petici√≥n se env√≠a el &lt;code class=&quot;highlighter-rouge&quot;&gt;response_type&lt;/code&gt; con valor a &lt;code class=&quot;highlighter-rouge&quot;&gt;token&lt;/code&gt; para indicarle al ‚ÄúAuthorization Server‚Äù que se va a usar el flujo ‚ÄúImplicit Grant‚Äù. La diferencia con el ‚ÄúAuthorization Code Grant‚Äù es que una vez el usuario final se autentica y otorga su consentimiento, el ‚ÄúAuthorization Server‚Äù hace la redirecci√≥n al &lt;code class=&quot;highlighter-rouge&quot;&gt;redirect_uri&lt;/code&gt; pas√°ndole el &lt;code class=&quot;highlighter-rouge&quot;&gt;access_token&lt;/code&gt; directamente como parte de la URL. Es decir, no existen los pasos 10) y 11) del flujo ‚ÄúAuthorization Code Grant‚Äù en el que se obtiene un &lt;code class=&quot;highlighter-rouge&quot;&gt;code&lt;/code&gt; temporal que hay que intercambiar por un &lt;code class=&quot;highlighter-rouge&quot;&gt;access_token&lt;/code&gt; haciendo uso del &lt;code class=&quot;highlighter-rouge&quot;&gt;client_secret&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Gracias a esto, no es necesario disponer de un &lt;code class=&quot;highlighter-rouge&quot;&gt;client_secret&lt;/code&gt; para llevar a cabo este flujo y por lo tanto, el flujo se puede utilizar en aplicaciones que no pueden almacenar secretos de forma segura.&lt;/p&gt;

&lt;p&gt;Todo esto suena muy bien pero si el ‚ÄúImplicit Grant‚Äù es m√°s simple que el ‚ÄúAuthorization Code Grant‚Äù y adem√°s no necesita secretos, ¬øpor qu√© no lo utilizamos en todos los casos?&lt;/p&gt;

&lt;h3 id=&quot;buena-pregunta&quot;&gt;Buena pregunta‚Ä¶&lt;/h3&gt;

&lt;p&gt;El caso es que este flujo tiene sus inconvenientes tal y como se recoge en la &lt;a href=&quot;https://tools.ietf.org/html/rfc6819&quot; target=&quot;_blank&quot;&gt;RFC6819&lt;/a&gt;:&lt;/p&gt;

&lt;h3 id=&quot;riesgo-de-interceptar-el-access_token&quot;&gt;Riesgo de interceptar el access_token&lt;/h3&gt;

&lt;p&gt;Tal y como se ha explicado, el &lt;code class=&quot;highlighter-rouge&quot;&gt;access_token&lt;/code&gt; viene como parte de la URL que hace la redirecci√≥n hacia la aplicaci√≥n cliente y no en el cuerpo de la respuesta de una petici√≥n POST como ocurre en flujo ‚ÄúAuthorization Code Grant‚Äù. Este detalle es muy importante ya que al venir el token en la URL, este puede quedar registrado en logs o hist√≥ricos. Por lo tanto, cualquiera con acceso a este tipo de informaci√≥n en la aplicaci√≥n cliente podr√≠a obtener el &lt;code class=&quot;highlighter-rouge&quot;&gt;access_token&lt;/code&gt; y explotarlo de manera ileg√≠tima.&lt;/p&gt;

&lt;p&gt;Para mitigar este problema, en lugar de utilizar un ‚Äúquery string‚Äù para pasar este valor, se utiliza &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/URL/hash&quot; target=&quot;_blank&quot;&gt;un fragmento o hash&lt;/a&gt;. Si nos fijamos en la URL del paso 6) del diagrama, podemos ver c√≥mo el &lt;code class=&quot;highlighter-rouge&quot;&gt;access_token&lt;/code&gt; se env√≠a como fragmento haciendo uso del caracter &lt;strong&gt;#&lt;/strong&gt;: https://‚Ä¶index.html#access_token=m4odaim6h‚Ä¶&lt;/p&gt;

&lt;p&gt;Los navegadores, no env√≠an la parte del fragmento al servidor. Esto quiere decir que cuando el navegador haga la petici√≥n a index.html para descargarse la aplicaci√≥n SPA, no enviar√° todo lo que sigue al caracter &lt;strong&gt;#&lt;/strong&gt;. De esta forma, se consigue limitar la superficie de un posible ataque ya que sabremos que el &lt;code class=&quot;highlighter-rouge&quot;&gt;access_token&lt;/code&gt; no quedar√° registrado en los logs del servidor en el que se aloja la aplicaci√≥n cliente. Sin embargo, el fragmento s√≠ que quedar√≠a almacenado en el hist√≥rico del navegador.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://tools.ietf.org/html/rfc6819#section-4.4.2&quot; target=&quot;_blank&quot;&gt;En este RFC&lt;/a&gt;, se enumeran esta y otras amenazas relacionadas. Incluso en la propia especificaci√≥n OAuth2 se alerta de las implicaciones de seguridad que tiene utilizar el flujo ‚ÄúImplicit Grant‚Äù:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Implicit grants improve the responsiveness and efficiency of some
   clients (such as a client implemented as an in-browser application),
   since it reduces the number of round trips required to obtain an
   access token.  However, &lt;strong&gt;this convenience should be weighed against
   the security implications of using implicit grants&lt;/strong&gt;, such as those
   described in Sections 10.3 and 10.16, especially when the
   authorization code grant type is available.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;no-permite-el-uso-de-refresh_token&quot;&gt;No permite el uso de refresh_token&lt;/h3&gt;

&lt;p&gt;En el punto anterior se ha comentado que la forma en la que las aplicaciones cliente obtienen el &lt;code class=&quot;highlighter-rouge&quot;&gt;access_token&lt;/code&gt; cuando se utiliza ‚ÄúImplicit Grant‚Äù no es demasiado seguro. Si bien es cierto que las consecuencias de una fuga de &lt;code class=&quot;highlighter-rouge&quot;&gt;access_token&lt;/code&gt; son limitadas porque los &lt;code class=&quot;highlighter-rouge&quot;&gt;access_token&lt;/code&gt; expiran en un periodo de tiempo muy corto, no se podr√≠a decir lo mismo de un &lt;code class=&quot;highlighter-rouge&quot;&gt;refresh_token&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Los &lt;code class=&quot;highlighter-rouge&quot;&gt;refresh_token&lt;/code&gt; tienen un ciclo de vida mucho m√°s largo ya que se utilizan para obtener nuevos &lt;code class=&quot;highlighter-rouge&quot;&gt;access_token&lt;/code&gt; sin necesidad de que el usuario final tenga que estar dando su consentimiento continuamente. En el caso de Google por ejemplo, el &lt;code class=&quot;highlighter-rouge&quot;&gt;refresh_token&lt;/code&gt; &lt;a href=&quot;https://developers.google.com/identity/protocols/OAuth2#expiration&quot; target=&quot;_blank&quot;&gt;caduca cuando no haya sido utilizado durante 6 meses&lt;/a&gt;. Por lo tanto, la fuga de un &lt;code class=&quot;highlighter-rouge&quot;&gt;refresh_token&lt;/code&gt; ser√≠a catastr√≥fico ya que podr√≠a utilizarse para generar &lt;code class=&quot;highlighter-rouge&quot;&gt;access_token&lt;/code&gt; durante un largo periodo de tiempo. Es por esto que la propia especificaci√≥n de OAuth2 advierte que la expedici√≥n de tokens de refresco no est√° soportada cuando se utiliza ‚ÄúImplicit Grant‚Äù.&lt;/p&gt;

&lt;p&gt;Como ya hemos dicho, el no poder utilizar tokens de refresco atenta contra la usabilidad ya que cada vez que el &lt;code class=&quot;highlighter-rouge&quot;&gt;access_token&lt;/code&gt; caduque, tendremos que volver a iniciar el flujo y redirigir al usuario al ‚ÄúAuthorization Server‚Äù para que vuelva a dar su consentimiento. Para dar respuesta a este problema, existe el concepto de ‚ÄúSilent Refresh‚Äù que consiste en utilizar un IFrame para obtener nuevos &lt;code class=&quot;highlighter-rouge&quot;&gt;access_tokens&lt;/code&gt; de forma silenciosa. Este ‚Äúhack‚Äù tiene varios condicionantes y riesgos que no se van a extender en este art√≠culo. Se puede leer m√°s informaci√≥n sobre c√≥mo efectuar un ‚Äúsilent refresh‚Äù &lt;a href=&quot;https://www.scottbrady91.com/OpenID-Connect/Silent-Refresh-Refreshing-Access-Tokens-when-using-the-Implicit-Flow&quot; target=&quot;_blank&quot;&gt;aqu√≠&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Si no recomendamos utilizar ni ‚ÄúResource Owner Password Credentials Grant‚Äù ni ‚ÄúImplicit Grant‚Äù para nuestras aplicaciones m√≥viles o SPAs, ¬øqu√© otras opciones tenemos? La respuesta a esta pregunta es‚Ä¶&lt;/p&gt;

&lt;h2 id=&quot;authorization-code-grant-with-pkce&quot;&gt;Authorization Code Grant with PKCE&lt;/h2&gt;

&lt;p&gt;El flujo ‚ÄúAuthorization Code Grant with PKCE‚Äù naci√≥ para dar respuesta a todos los problemas asociados a las aplicaciones p√∫blicas (SPAs y m√≥viles) ya que se trata de una extensi√≥n de ‚ÄúAuthorization Code Grant‚Äù dirigido a este tipo de aplicaciones. Las motivaciones y particularidades de este flujo se recogen en la &lt;a href=&quot;https://tools.ietf.org/html/rfc7636&quot; target=&quot;_blank&quot;&gt;RFC 7636&lt;/a&gt; y este es su diagrama correspondiente:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/images/2020-01-27-oauth2/authz-code-grant-pkce.png&quot; target=&quot;_blank&quot;&gt;&lt;img src=&quot;/assets/images/2020-01-27-oauth2/authz-code-grant-pkce.png&quot; alt=&quot;Authorization code grant with PKCE&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Tal y como se puede ver en el diagrama, el flujo es id√©ntico a un ‚ÄúAuthorization Code Grant‚Äù solo que en el paso 1) se a√±ade un par√°metro extra llamado &lt;code class=&quot;highlighter-rouge&quot;&gt;code_challenge&lt;/code&gt; y en el paso 7) en lugar de enviar el &lt;code class=&quot;highlighter-rouge&quot;&gt;client_secret&lt;/code&gt; se env√≠a otro par√°metro denominado &lt;code class=&quot;highlighter-rouge&quot;&gt;code_verifier&lt;/code&gt;. Es decir, la combinaci√≥n de &lt;code class=&quot;highlighter-rouge&quot;&gt;code_challenge&lt;/code&gt; + &lt;code class=&quot;highlighter-rouge&quot;&gt;code_verifier&lt;/code&gt; sustituyen al &lt;code class=&quot;highlighter-rouge&quot;&gt;client_secret&lt;/code&gt; creando una especie de secreto temporal y √∫nico por cada flujo.&lt;/p&gt;

&lt;h3 id=&quot;c√≥mo-funciona-esto&quot;&gt;¬øC√≥mo funciona esto?&lt;/h3&gt;

&lt;p&gt;Al inicio del flujo, la aplicaci√≥n cliente genera un &lt;code class=&quot;highlighter-rouge&quot;&gt;code_verifier&lt;/code&gt; que no es m√°s que un string aleatorio criptogr√°fico que tiene que cumplir &lt;a href=&quot;https://tools.ietf.org/html/rfc7636#section-4.1&quot; target=&quot;_blank&quot;&gt;una serie de condiciones&lt;/a&gt;. A continuaci√≥n, se crea el &lt;code class=&quot;highlighter-rouge&quot;&gt;code_challenge&lt;/code&gt; que es un derivado del &lt;code class=&quot;highlighter-rouge&quot;&gt;code_verifier&lt;/code&gt;. Hay m√∫ltiples formas de generar el &lt;code class=&quot;highlighter-rouge&quot;&gt;code_challenge&lt;/code&gt; pero la recomendaci√≥n es utilizar SHA-256 aplicando una f√≥rmula del estilo &lt;code class=&quot;highlighter-rouge&quot;&gt;code_challenge = BASE64URL-ENCODE(SHA256(ASCII(code_verifier)))&lt;/code&gt;. La forma en la que se hace la verificaci√≥n de este ‚Äúchallenge‚Äù es la siguiente:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;En el primer paso del flujo, la aplicaci√≥n cliente guarda el &lt;code class=&quot;highlighter-rouge&quot;&gt;code_verifier&lt;/code&gt; y env√≠a el &lt;code class=&quot;highlighter-rouge&quot;&gt;code_challenge&lt;/code&gt; al ‚ÄúAuthorization Server‚Äù.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;El ‚ÄúAuthorization Server‚Äù almacena el &lt;code class=&quot;highlighter-rouge&quot;&gt;code_challenge&lt;/code&gt; recibido y una vez que el usuario da su consentimiento, responde con el &lt;code class=&quot;highlighter-rouge&quot;&gt;code&lt;/code&gt;.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Cuando la aplicaci√≥n cliente va a intercambiar el &lt;code class=&quot;highlighter-rouge&quot;&gt;code&lt;/code&gt; por el &lt;code class=&quot;highlighter-rouge&quot;&gt;access_token&lt;/code&gt; en el paso 7), env√≠a tambi√©n el &lt;code class=&quot;highlighter-rouge&quot;&gt;code_verifier&lt;/code&gt; que hab√≠a guardado previamente y que es el origen desde el que se hab√≠a creado el &lt;code class=&quot;highlighter-rouge&quot;&gt;code_challenge&lt;/code&gt; enviado en el primer paso.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Por √∫ltimo, el ‚ÄúAuthorization Server‚Äù aplica la f√≥rmula de derivaci√≥n sobre este &lt;code class=&quot;highlighter-rouge&quot;&gt;code_verifier&lt;/code&gt; y lo compara con el &lt;code class=&quot;highlighter-rouge&quot;&gt;code_challenge&lt;/code&gt; que hab√≠a guardado en el primer paso. Si los c√≥digos son iguales, la petici√≥n es v√°lida y devuelve el &lt;code class=&quot;highlighter-rouge&quot;&gt;access_token&lt;/code&gt; y opcionalmente el &lt;code class=&quot;highlighter-rouge&quot;&gt;refresh_token&lt;/code&gt;. Los criterios que sigue el ‚ÄúAuthorization Server‚Äù para devolver o no un &lt;code class=&quot;highlighter-rouge&quot;&gt;refresh_token&lt;/code&gt; son los mismos que en el ‚ÄúAuthorization Code Grant‚Äù.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Por lo tanto, este flujo tienes las ventajas del ‚ÄúAuthorization Code Grant‚Äù y puede utilizarse sin necesidad de disponer de un secreto ‚Äúest√°tico‚Äù ya que este se genera en caliente cada vez que se inicia un nuevo flujo.&lt;/p&gt;

&lt;h2 id=&quot;conclusiones&quot;&gt;Conclusiones&lt;/h2&gt;

&lt;p&gt;En este art√≠culo se ha hecho una introducci√≥n a OAuth en el que se han explicado cu√°les fueron las motivaciones para su creaci√≥n as√≠ como la forma en la que funciona.&lt;/p&gt;

&lt;p&gt;Se han repasado los principales flujos que se contemplan en la especificaci√≥n para permitir a un usuario dar autorizaci√≥n a aplicaciones de terceros con el objetivo de que puedan realizar acciones en su nombre.&lt;/p&gt;

&lt;p&gt;Si bien para aplicaciones web tradicionales en las que el renderizado de los HTML se realiza en servidor el flujo a utilizar est√° muy claro (Authorization Code Grant), cuando tratamos de buscar el flujo a utilizar para SPAs o aplicaciones m√≥viles la informaci√≥n disponible es bastante confusa.&lt;/p&gt;

&lt;p&gt;Debido a la evoluci√≥n de la especificaci√≥n o a la ambig√ºedad del propio texto, es f√°cil encontrar en internet art√≠culos o comentarios en los que se invita a utilizar flujos que son potencialmente peligrosos como pueden ser ‚ÄúResource Owner Password Grant‚Äù o ‚ÄúImplicit Grant‚Äù. &lt;strong&gt;La recomendaci√≥n es que para este tipo de aplicaciones se utilice el flujo ‚ÄúAuthorization Code Grant with PKCE‚Äù que salva la problem√°tica de los secretos haciendo uso de criptograf√≠a.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;En este art√≠culo se han dejado a un lado los flujos en los que no interviene el usuario como puede ser el ‚ÄúClient Credentials Grant‚Äù u otros en los que no se utiliza un navegador como el ‚ÄúDevice Authorization Grant‚Äù. De igual forma, se ha hablado solo de autorizaci√≥n que es lo que cubre OAuth y dejado a un lado la autenticaci√≥n. Quiz√°s tratemos estos temas relacionados en futuras publicaciones.&lt;/p&gt;

&lt;p&gt;Por √∫ltimo, se ha visto que OAuth no es un protocolo sencillo de implementar y por lo tanto se recomienda utilizar librer√≠as ya existentes que encapsulen toda esta complejidad.&lt;/p&gt;</content><author><name>aritz</name></author><category term="autenticaci√≥n," /><category term="oauth," /><category term="oauth2," /><category term="resource" /><category term="owner" /><category term="password" /><category term="credentials," /><category term="authorization" /><category term="code," /><category term="implicit," /><category term="silent" /><category term="refresh" /><summary type="html">El est√°ndar OAuth2 es tan conocido como complejo. El hecho de que sea un est√°ndar en evoluci√≥n y el exceso de informaci√≥n disponible, hace que sea muy f√°cil encontrar art√≠culos con informaci√≥n contradictoria o que se recomiende el uso de flujos que actualmente se consideran ‚Äúlegacy‚Äù por motivos de seguridad.</summary></entry><entry xml:lang="es"><title type="html">Hemos estado en la Commit Conf 2019</title><link href="https://blog.arima.eu/es/2019/12/02/commit-conf-2019.html" rel="alternate" type="text/html" title="Hemos estado en la Commit Conf 2019" /><published>2019-12-02T09:00:00+00:00</published><updated>2019-12-02T09:00:00+00:00</updated><id>https://blog.arima.eu/2019/12/02/commit-conf-2019</id><content type="html" xml:base="https://blog.arima.eu/2019/12/02/commit-conf-2019.html">&lt;p&gt;Hace dos semanas asist√≠ a la Commit Conf 2019 en Madrid! en este post os voy a contar un poco mi experiencia all√≠ y qu√© charlas me llamaron m√°s la atenci√≥n.&lt;/p&gt;

&lt;center&gt;
&lt;blockquote class=&quot;twitter-tweet&quot;&gt;
&lt;div dir=&quot;ltr&quot; lang=&quot;es&quot;&gt;
Egun on Madrid! Ya estamos preparados para que empiece la &lt;a href=&quot;https://twitter.com/hashtag/commitconf?src=hash&amp;amp;ref_src=twsrc%5Etfw&quot;&gt;#commitconf&lt;/a&gt; &lt;a href=&quot;https://t.co/QUdSZIkOkA&quot;&gt;pic.twitter.com/QUdSZIkOkA&lt;/a&gt;&lt;/div&gt;
‚Äî Fernando Lozano (@frlzno) &lt;a href=&quot;https://twitter.com/frlzno/status/1197791163169886208?ref_src=twsrc%5Etfw&quot;&gt;November 22, 2019&lt;/a&gt;&lt;/blockquote&gt;
&lt;/center&gt;
&lt;script async=&quot;&quot; charset=&quot;utf-8&quot; src=&quot;https://platform.twitter.com/widgets.js&quot;&gt;&lt;/script&gt;

&lt;p&gt;&lt;strong&gt;La Commit&lt;/strong&gt; en general estuvo muy bien, al tener bastante variedad y cantidad de charlas (140 en dos d√≠as) siempre tienes alguna charla que a priori parece interesante. Antes de ir a la Commit, me llam√≥ la atenci√≥n preparando las charlas a las que iba a ir, ver la cantidad de charlas sobre Microservicios y DevOps que hab√≠a, entiendo que sean temas que est√°n en auge pero que todo el mundo hable de lo mismo, me empieza a aburrir.&lt;/p&gt;

&lt;p&gt;Sobre &lt;strong&gt;los ponentes&lt;/strong&gt;, la mayor√≠a muy buenos, saben transmitir esa confianza sobre el escenario que parecen estar en el sal√≥n de su casa. Tambi√©n los hab√≠a m√°s ‚Äúnovatos‚Äù a los que se les notaba m√°s nerviosos, con sus miedos y fobias a hablar en p√∫blico pero que tambi√©n lo hicieron muy bien.&lt;/p&gt;

&lt;p&gt;Sin embargo, no todo es de color de rosa, es una &lt;strong&gt;conferencia bastante masificada&lt;/strong&gt;, a pesar de que hay nueve tracks, fuese a la charla que fuese siempre estaba llena. La gente sentada en el suelo de las aulas, de pie, corriendo de un lado a otro‚Ä¶ daba una sensaci√≥n de agobio constante. Al final lo que hac√≠a la gente es salir antes de las charlas para coger sitio en las siguientes.&lt;/p&gt;

&lt;p&gt;Dejando a un lado un poco mis impresiones generales de la Commit Conf, me gustar√≠a destacar cu√°les fueron las que m√°s me llamaron la atenci√≥n:&lt;/p&gt;

&lt;p&gt;Una de las mejores charlas a la que fui, la primera de la Commit, fue la de &lt;strong&gt;‚ÄúRefactorizar rima con Simplificar, o por qu√© el miedo conduce a c√≥digo inmantenible‚Äù&lt;/strong&gt; de Javier Abad√≠a. Javier nos ayudaba a entender la importancia de refactorizar y de dejar nuestros miedos a un lado a la hora de hacerlo.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/2019-12-02-commit-conf-2019/1.jpeg&quot; alt=&quot;Refactorizar rima con Simplificar, o por qu√© el miedo conduce a c√≥digo inmantenible&quot; class=&quot;center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Otra buena charla fue la de &lt;strong&gt;‚ÄúEl futuro es ahora: WebAssembly‚Äù&lt;/strong&gt; de Daniel Ramos. Web Assembly es una iniciativa liderada por equipos de desarrollo de Microsoft, Mozilla y Google dise√±ada para ejecutar c√≥digo nativo (bytecode) en un navegador sin necesidad de instalar nada extra en √©l.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/2019-12-02-commit-conf-2019/2.jpeg&quot; alt=&quot;El futuro es ahora: WebAssembly&quot; class=&quot;center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;JavaScript en su d√≠a no se pens√≥ para lo que se est√° utilizando ahora, es verdad que ha ido evolucionando pero todav√≠a no puede competir en rendimiento con c√≥digo C y C++. Aqu√≠ es donde entra WebAssembly. Utiliza la potencia que tienen lenguajes de m√°s alto nivel y se compilan a c√≥digo nativo para que luego posteriormente sea utilizado en el navegador.&lt;/p&gt;

&lt;p&gt;Est√° m√°s orientado a realidad virtual, herramientas de colaboraci√≥n, software CAD, simulaci√≥n cient√≠fica‚Ä¶ Pero al final se puede aplicar a multitud de casos. En la presentaci√≥n Daniel coment√≥ que las aplicaciones web de Autocad y Lightroom usan esta tecnolog√≠a.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://takahirox.github.io/WebAssembly-benchmark/&quot; target=&quot;_blank&quot;&gt;Aqu√≠&lt;/a&gt; ten√©is algunos ejemplos online comparando lo que tarda Javascript vs WebAssembly, como pod√©is ver hay algunos casos donde sale m√°s rentable utilizar WebAssembly.&lt;/p&gt;

&lt;p&gt;Otra charla que me pareci√≥ interesante fue la que dieron Manuel Vilach√°n y Antonio Marin titulada &lt;strong&gt;‚ÄúWebAuthn: No m√°s passwords por favor!‚Äù&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/2019-12-02-commit-conf-2019/3.jpeg&quot; alt=&quot;WebAuthn: No m√°s passwords por favor!&quot; class=&quot;center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;WebAuthn es un est√°ndar web oficial de la W3C que permite el inicio de sesi√≥n en Internet, en todo tipo de servicios online, sin necesidad de un usuario y contrase√±a. En su lugar, los usuarios pueden hacer uso de los datos biom√©tricos, tokens para hardware y aplicaciones determinadas.&lt;/p&gt;

&lt;p&gt;Con este m√©todo, las p√°ginas web que verifican la identidad del usuario recurren a la API de autenticaci√≥n web en el navegador. El usuario, por su parte, confirma ser quien es en su propio equipo con un esc√°ner de huella dactilar o con un token conectado a su ordenador. Los datos personales de identidad, como la huella digital, no salen fuera del dispositivo. Es el navegador el que env√≠a la verificaci√≥n de su identidad, cifrada por medio de una clave p√∫blica al servicio web.&lt;/p&gt;

&lt;p&gt;Como pod√©is ver en &lt;a href=&quot;https://caniuse.com/#search=webauthn&quot; target=&quot;_blank&quot;&gt;Can I Use&lt;/a&gt; la mayor√≠a de las versiones estables de los principales navegadores lo soportan.&lt;/p&gt;

&lt;p&gt;WebAuthn ofrece varias ventajas para los usuarios. La comodidad es el factor que deber√≠a convencernos a todos, ya no tenemos que memorizar m√°s contrase√±as! De aqu√≠ tambi√©n se derivar√≠a una mayor seguridad, porque el uso de claves no es un m√©todo seguro al cien por cien, ya que pueden romperse con ataques de fuerza bruta y son f√°ciles de interceptar con phishing. Tampoco permiten lanzar un ataque de man in the middle, puesto que no se env√≠an datos sensibles que pueden ser interceptados. El m√©todo de clave p√∫blica protege de forma criptogr√°fica el env√≠o del certificado de autenticaci√≥n.&lt;/p&gt;

&lt;p&gt;El mayor inconveniente aparece en el momento de intentar loguearte con diferentes dispositivos, es decir, si t√∫ quieres acceder a Twitter, desde el m√≥vil, desde el escritorio, desde cualquier otro dispositivo, debes registrar un nuevo autenticador en la aplicaci√≥n web por cada dispositivo, por lo que puede ser un poco engorro tener que hacer eso por cada dispositivo nuevo.&lt;/p&gt;

&lt;p&gt;Y por √∫ltimo, para m√≠ LA charla, &lt;strong&gt;‚ÄúUnbiasing teams‚Äù&lt;/strong&gt; de F√©lix L√≥pez. Una charla que recomiendo verla en v√≠deo cuando lo suban a Youtube. Es una charla bastante densa y poco t√©cnica pero que a m√≠ me encant√≥. F√©lix explica los factores psicol√≥gicos que nos afectan en el d√≠a a d√≠a en la toma de decisiones y en el comportamiento personal con el resto del equipo. Con una serie de ejemplos nos explica c√≥mo a veces vemos situaciones como normales que en realidad est√°n fundamentadas en esquemas y estereotipos.&lt;/p&gt;

&lt;p&gt;Me ha parecido una conferencia de lo m√°s completa, dos d√≠as llenos de charlas variadas e interesantes. Una experiencia enriquecedora y satisfactoria. Quiero dar las gracias a la organizaci√≥n y voluntarios por su excelente trabajo y por su disponibilidad en todo momento.&lt;/p&gt;

&lt;p&gt;En el canal de &lt;a href=&quot;https://www.youtube.com/channel/UCd_1KHg4t2VKGsSDF8OD5Cw&quot; target=&quot;_blank&quot;&gt;Youtube&lt;/a&gt; de Commit encontrar√°s las charlas que he mencionado en este post.&lt;/p&gt;

&lt;p&gt;¬°Hasta el a√±o que viene!&lt;/p&gt;</content><author><name>fernando</name></author><category term="conferencias," /><category term="commit" /><category term="conf" /><summary type="html">Hace dos semanas asist√≠ a la Commit Conf 2019 en Madrid! en este post os voy a contar un poco mi experiencia all√≠ y qu√© charlas me llamaron m√°s la atenci√≥n.</summary></entry><entry xml:lang="es"><title type="html">Nuestro proceso de selecci√≥n</title><link href="https://blog.arima.eu/es/2019/10/24/arima-proceso-seleccion.html" rel="alternate" type="text/html" title="Nuestro proceso de selecci√≥n" /><published>2019-10-24T09:00:00+00:00</published><updated>2019-10-24T09:00:00+00:00</updated><id>https://blog.arima.eu/2019/10/24/arima-proceso-seleccion</id><content type="html" xml:base="https://blog.arima.eu/2019/10/24/arima-proceso-seleccion.html">&lt;p&gt;Por lo general, los procesos de selecci√≥n suelen convertirse en situaciones inc√≥modas para los candidatos. A los nervios habituales, se une el hecho de que los entrevistadores recurren cada vez m√°s a t√©cnicas en las que se busca incomodar al entrevistado. Para conseguir este objetivo, es habitual hacer preguntas extra√±as o provocar situaciones tensas que pretenden psicoanalizar a los candidatos. Desde los t√≠picos ¬øcu√°l es tu mayor virtud? o ¬øcu√°l es tu mayor defecto? (al que la mayor√≠a contesta  que ser demasiado perfeccionista), hasta otro tipo de cuestiones mucho m√°s impertinentes y personales que tienen como objetivo analizar el comportamiento del candidato en situaciones de tensi√≥n.&lt;/p&gt;

&lt;p&gt;A estas preguntas que podemos considerar m√°s personales, hay que a√±adir que muchas empresas tecnol√≥gicas incorporan pruebas pr√°cticas a los que los candidatos se tienen que enfrentar delante de una pizarra. Cuanto m√°s grande (y cool) sea la empresa aparentemente, m√°s probable es que incluyan este tipo de pruebas en sus procesos de selecci√≥n. Habitualmente, en este tipo de ejercicios se pide a los candidatos que implementen algoritmos de ordenaci√≥n u otro tipo de ejercicios de bajo nivel con la √∫nica ayuda de un rotulador y la famosa pizarra blanca. Se dice que esta tendencia comenz√≥ en Microsoft debido a que a Bill Gates le encantaban los rompecabezas.&lt;/p&gt;

&lt;p&gt;Si tengo que ser sincero, estoy seguro de que yo no ser√≠a capaz de pasar ninguna de esas pruebas. Necesitar√≠a de una preparaci√≥n espec√≠fica para superar ese tipo de ejercicios. A menudo, me encuentro a m√≠ mismo haciendo b√∫squedas absurdas en Google o Stackoverflow para recordar por ejemplo, c√≥mo se eliminan los espacios en blanco de un string en un lenguaje de programaci√≥n determinado. ¬øMe convierte eso en un mal programador? No necesariamente‚Ä¶&lt;/p&gt;

&lt;p&gt;En ARIMA no pretendemos que los candidatos cumplan las funciones de un compilador o que sean capaces de escribir en una pizarra el c√≥digo Java correspondiente a un algoritmo de ordenaci√≥n de arrays. Esta no es una forma realista de valorar candidatos ya que no es la forma en la que se trabaja en el d√≠a a d√≠a. Para hacer ese tipo de tareas ya est√°n los IDEs, los compiladores, las librer√≠as que implementan algoritmos e internet para buscarlos.&lt;/p&gt;

&lt;p&gt;Lo que s√≠ nos gusta es sentarnos delante de un bloque de c√≥digo y compartir impresiones sobre el mismo. Nos encanta discutir sobre c√≥digo y cualquier excusa es buena:  desde un proyecto personal, hasta alg√∫n peque√±o ejercicio que nosotros hayamos podido enviar para implementar en casa y sin ning√∫n tipo de presi√≥n. Cuando optamos por enviar un ejercicio, siempre se trata de cosas muy sencillas como puede ser implementar un CRUD en un lenguaje en el que los candidatos se sienten c√≥modos. M√°s que el resultado del ejercicio, lo que nos interesa conocer es el por qu√© de las decisiones que se han tomado en el proceso. Esto puede proporcionar mucha informaci√≥n sobre la forma que tiene cada persona de razonar y afrontar los desarrollos.&lt;/p&gt;

&lt;p&gt;En cuanto a la parte personal, nos gusta que la gente nos hable de sus inquietudes, lo que le gusta hacer y lo que le ha motivado a la hora de elegir el desarrollo de software como oficio. No hay preguntas trampa para las que hay que traer una respuesta preparada desde casa, simplemente queremos conocer a la persona.&lt;/p&gt;

&lt;p&gt;Creemos que esta forma de acometer los procesos de selecci√≥n son mucho menos hostiles y fomentan que los candidatos puedan presentarse tal y como son en un entorno tranquilo. A f√≠n de cuentas, crear situaciones de estr√©s o hacer que las personas se sientan acorraladas, no parece la mejor forma de iniciar una relaci√≥n laboral duradera.&lt;/p&gt;

&lt;p&gt;En ARIMA siempre estamos interesados en conocer e incorporar desarrolladores al equipo que nos ayuden a ser mejores. Si tienes inter√©s en conocernos, no dudes en contactarnos enviando un email a &lt;a href=&quot;arima@arima.eu&quot;&gt;arima@arima.eu&lt;/a&gt;. H√°blanos sobre ti present√°ndote tal y como eres y dejando a un lado las t√≠picas plantillas de carta de presentaci√≥n fr√≠as y formales.&lt;/p&gt;</content><author><name>aritz</name></author><category term="recruiting," /><category term="contrataci√≥n," /><category term="proceso" /><category term="de" /><category term="selecci√≥n," /><category term="remote" /><category term="working" /><summary type="html">Por lo general, los procesos de selecci√≥n suelen convertirse en situaciones inc√≥modas para los candidatos. A los nervios habituales, se une el hecho de que los entrevistadores recurren cada vez m√°s a t√©cnicas en las que se busca incomodar al entrevistado. Para conseguir este objetivo, es habitual hacer preguntas extra√±as o provocar situaciones tensas que pretenden psicoanalizar a los candidatos. Desde los t√≠picos ¬øcu√°l es tu mayor virtud? o ¬øcu√°l es tu mayor defecto? (al que la mayor√≠a contesta que ser demasiado perfeccionista), hasta otro tipo de cuestiones mucho m√°s impertinentes y personales que tienen como objetivo analizar el comportamiento del candidato en situaciones de tensi√≥n.</summary></entry><entry xml:lang="es"><title type="html">[CSS] Switch off the lights</title><link href="https://blog.arima.eu/es/2019/10/11/switch-off-the-lights.html" rel="alternate" type="text/html" title="[CSS] Switch off the lights" /><published>2019-10-11T09:00:00+00:00</published><updated>2019-10-11T09:00:00+00:00</updated><id>https://blog.arima.eu/2019/10/11/switch-off-the-lights</id><content type="html" xml:base="https://blog.arima.eu/2019/10/11/switch-off-the-lights.html">&lt;p&gt;El ‚Äúmodo oscuro‚Äù en las interfaces de usuario se ha puesto de moda el √∫ltimo a√±o. Antes eran pocas las aplicaciones (nativas o webapps) que ten√≠an una interfaz alternativa a la de colores blancos/claros que utilizan la mayor√≠a de UIs por defecto. Y las que lo ofrec√≠an (por ejemplo, Youtube) lo tienen escondido de tal forma que hay que activarlo como opci√≥n en los men√∫s de configuraci√≥n de la propia aplicaci√≥n. Es decir, hab√≠a pocas aplicaciones que lo ofrec√≠an y adem√°s se necesitaba bucear entre las opciones para ver si lo ofrec√≠an y en caso afirmativo activarlo en cada una de ellas: cocktail perfecto para que en la pr√°ctica no lo utilizase pr√°cticamente nadie y, en consecuencia a su vez, no existiese ning√∫n aliciente para ofrecer ese modo oscuro.&lt;/p&gt;

&lt;p&gt;Sin embargo macOS estren√≥ con su versi√≥n Mojave/10.14 (septiembre de 2018) una configuraci√≥n global para poner todo el sistema operativo en modo oscuro (men√∫s, el Finder, etc.) y ofrecer a las aplicaciones nativas esta informaci√≥n (si el usuario ha elegido un tema claro u oscuro) para poder integrarse en el sistema operativo autom√°ticamente. A partir de ah√≠ muchas aplicaciones nativas se han ido actualizando para respetar esta configuraci√≥n (por ejemplo Firefox y Chrome han lanzado estos √∫ltimos meses interfaces oscuras del propio navegador para los que tenemos el modo oscuro activado), ha llegado tambi√©n a Windows, y ha dado el salto a m√≥viles implement√°ndose oficialmente en Android 10 e iOS 13 (aunque desde Android 9 ya se pod√≠a activar en muchos m√≥viles) donde adem√°s tiene el aliciente del ahorro de bater√≠a en pantallas AMOLED, etc.&lt;/p&gt;

&lt;p&gt;Y, lo que nos interesa, es que esta configuraci√≥n ha saltado tambi√©n a CSS. La propuso WebKit implement√°ndola en Safari 12.1 y ya se ha lanzado tambi√©n en Firefox (67+) y Chrome de escritorio (77+), aunque por alguna raz√≥n a√∫n no en Chrome de Android (caniuse). Estamos hablando de la media query &lt;em&gt;prefers-color-scheme&lt;/em&gt; (MDN).&lt;/p&gt;

&lt;p&gt;Esto permite ejecutar CSS espec√≠fico seg√∫n las preferencias de tema del usuario en su sistema operativo (de escritorio o m√≥vil). En la pr√°ctica, podemos hacer algo as√≠:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;body {
  background: #eee;
  color: #111;
}

@media (prefers-color-scheme: dark) {
  body {
    background: #111;
    color: #eee;
  }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Con esto tendr√≠amos un tema oscuro para quien as√≠ tenga configurada la preferencia en su sistema operativo, y un tema tradicional claro para todos los dem√°s (incluidos aquellos navegadores que a√∫n no soporten esta nueva media query).&lt;/p&gt;

&lt;p&gt;Pod√©is probarlo con la versi√≥n de cualquier navegador de escritorio esta mini demo que he hecho: &lt;a href=&quot;https://typescript-rf4g1k.stackblitz.io/&quot; target=&quot;_blank&quot;&gt;https://typescript-rf4g1k.stackblitz.io/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/2019-10-11-switch-off-the-lights/demo.gif&quot; alt=&quot;demo&quot; class=&quot;center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Si jug√°is, como en el GIF, con la configuraci√≥n System Preferences -&amp;gt; General -&amp;gt; Appearance, al cambiar entre el modo Light y Dark cambiar√° no solo la interfaz de macOS y la UI del navegador, sino tambi√©n nuestra propia web. Yay!&lt;/p&gt;

&lt;p&gt;Y, de hecho, con el CSS puro actual podemos jugar a√∫n m√°s: podr√≠amos utilizar variables CSS y conseguir algo as√≠:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;:root {
    --background-color: #eee;
    --text-color: #111;
}

@media (prefers-color-scheme: dark) {
    :root {
        --background-color: #111;
        --text-color: #eee;
    }
}

body {
  background: var(--background-color);
  color: var(--text-color);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Definir todos los colores que utilicemos en nuestra UI como variables y reescribir el tema oscuro con esta nueva media query. Y esto funcionar√≠a igual que lo anterior, out of the box sin ning√∫n pre-tratamiento necesario de Sass/PostCSS/etc.&lt;/p&gt;</content><author><name>alberto</name></author><category term="css," /><category term="dark," /><category term="light," /><category term="claro," /><category term="oscuro" /><summary type="html">El ‚Äúmodo oscuro‚Äù en las interfaces de usuario se ha puesto de moda el √∫ltimo a√±o. Antes eran pocas las aplicaciones (nativas o webapps) que ten√≠an una interfaz alternativa a la de colores blancos/claros que utilizan la mayor√≠a de UIs por defecto. Y las que lo ofrec√≠an (por ejemplo, Youtube) lo tienen escondido de tal forma que hay que activarlo como opci√≥n en los men√∫s de configuraci√≥n de la propia aplicaci√≥n. Es decir, hab√≠a pocas aplicaciones que lo ofrec√≠an y adem√°s se necesitaba bucear entre las opciones para ver si lo ofrec√≠an y en caso afirmativo activarlo en cada una de ellas: cocktail perfecto para que en la pr√°ctica no lo utilizase pr√°cticamente nadie y, en consecuencia a su vez, no existiese ning√∫n aliciente para ofrecer ese modo oscuro.</summary></entry></feed>